<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 16 Exploring associations | Exploratory Data Analysis with R</title>
  <meta name="description" content="This is the Exploratory Data Analysis in R book provided by the School of Biosciences at the University of Sheffield." />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 16 Exploring associations | Exploratory Data Analysis with R" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This is the Exploratory Data Analysis in R book provided by the School of Biosciences at the University of Sheffield." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 16 Exploring associations | Exploratory Data Analysis with R" />
  
  <meta name="twitter:description" content="This is the Exploratory Data Analysis in R book provided by the School of Biosciences at the University of Sheffield." />
  

<meta name="author" content="Dylan Childs" />


<meta name="date" content="2021-04-17" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="exploring-one-variable.html"/>
<link rel="next" href="doing-more-with-ggplot2.html"/>
<script src="libs/header-attrs-2.7/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<link href="libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="libs/pagedtable-1.1/js/pagedtable.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Exploratory Data Analysis with R</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>What you will learn</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#aims"><i class="fa fa-check"></i>Aims</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#topics"><i class="fa fa-check"></i>Topics</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#technologies"><i class="fa fa-check"></i>Technologies</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#what-is-r"><i class="fa fa-check"></i>What is R?</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#what-is-rstudio"><i class="fa fa-check"></i>What is RStudio?</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="how-to-use-this-book.html"><a href="how-to-use-this-book.html"><i class="fa fa-check"></i>How to use this book</a>
<ul>
<li class="chapter" data-level="" data-path="how-to-use-this-book.html"><a href="how-to-use-this-book.html#text-instructions-and-explanations"><i class="fa fa-check"></i>Text, instructions, and explanations</a></li>
<li class="chapter" data-level="" data-path="how-to-use-this-book.html"><a href="how-to-use-this-book.html#r-code-and-output"><i class="fa fa-check"></i>R code and output</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="get-up-and-running.html"><a href="get-up-and-running.html"><i class="fa fa-check"></i>Get up and running</a>
<ul>
<li class="chapter" data-level="" data-path="get-up-and-running.html"><a href="get-up-and-running.html#different-ways-to-run-rstudio"><i class="fa fa-check"></i>Different ways to run RStudio</a></li>
<li class="chapter" data-level="" data-path="get-up-and-running.html"><a href="get-up-and-running.html#installing-r-and-rstudio-locally"><i class="fa fa-check"></i>Installing R and RStudio locally</a>
<ul>
<li class="chapter" data-level="" data-path="get-up-and-running.html"><a href="get-up-and-running.html#installing-rstudio"><i class="fa fa-check"></i>Installing RStudio</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="get-up-and-running.html"><a href="get-up-and-running.html#a-quick-look-at-rstudio"><i class="fa fa-check"></i>A quick look at RStudio</a></li>
<li class="chapter" data-level="" data-path="get-up-and-running.html"><a href="get-up-and-running.html#working-at-console"><i class="fa fa-check"></i>Working at the Console in RStudio</a></li>
</ul></li>
<li class="part"><span><b>I Introduction to R</b></span></li>
<li class="chapter" data-level="1" data-path="quick-intro-to-r.html"><a href="quick-intro-to-r.html"><i class="fa fa-check"></i><b>1</b> A quick introduction to R</a>
<ul>
<li class="chapter" data-level="1.1" data-path="quick-intro-to-r.html"><a href="quick-intro-to-r.html#r-calculator"><i class="fa fa-check"></i><b>1.1</b> Using R as a big calculator</a>
<ul>
<li class="chapter" data-level="1.1.1" data-path="quick-intro-to-r.html"><a href="quick-intro-to-r.html#basic-arithmetic"><i class="fa fa-check"></i><b>1.1.1</b> Basic arithmetic</a></li>
<li class="chapter" data-level="1.1.2" data-path="quick-intro-to-r.html"><a href="quick-intro-to-r.html#combining-arithmetic-operations"><i class="fa fa-check"></i><b>1.1.2</b> Combining arithmetic operations</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="quick-intro-to-r.html"><a href="quick-intro-to-r.html#problematic-calculations"><i class="fa fa-check"></i><b>1.2</b> Problematic calculations</a></li>
<li class="chapter" data-level="1.3" data-path="quick-intro-to-r.html"><a href="quick-intro-to-r.html#assignment"><i class="fa fa-check"></i><b>1.3</b> Storing and reusing results</a></li>
<li class="chapter" data-level="1.4" data-path="quick-intro-to-r.html"><a href="quick-intro-to-r.html#how-does-assignment-work"><i class="fa fa-check"></i><b>1.4</b> How does assignment work?</a></li>
<li class="chapter" data-level="1.5" data-path="quick-intro-to-r.html"><a href="quick-intro-to-r.html#global-environment"><i class="fa fa-check"></i><b>1.5</b> Global environment</a></li>
<li class="chapter" data-level="1.6" data-path="quick-intro-to-r.html"><a href="quick-intro-to-r.html#naming-rules-and-conventions"><i class="fa fa-check"></i><b>1.6</b> Naming rules and conventions</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="using-functions.html"><a href="using-functions.html"><i class="fa fa-check"></i><b>2</b> Using functions</a>
<ul>
<li class="chapter" data-level="2.1" data-path="using-functions.html"><a href="using-functions.html#intro-functions"><i class="fa fa-check"></i><b>2.1</b> Introduction</a></li>
<li class="chapter" data-level="2.2" data-path="using-functions.html"><a href="using-functions.html#functions-and-arguments"><i class="fa fa-check"></i><b>2.2</b> Functions and arguments</a></li>
<li class="chapter" data-level="2.3" data-path="using-functions.html"><a href="using-functions.html#evaluating-arguments-and-returning-results"><i class="fa fa-check"></i><b>2.3</b> Evaluating arguments and returning results</a></li>
<li class="chapter" data-level="2.4" data-path="using-functions.html"><a href="using-functions.html#function-arguments"><i class="fa fa-check"></i><b>2.4</b> Specifying function arguments</a></li>
<li class="chapter" data-level="2.5" data-path="using-functions.html"><a href="using-functions.html#combining-functions"><i class="fa fa-check"></i><b>2.5</b> Combining functions</a></li>
<li class="chapter" data-level="2.6" data-path="using-functions.html"><a href="using-functions.html#functions-do-not-have-side-effects"><i class="fa fa-check"></i><b>2.6</b> Functions do not have ‘side effects’</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="vectors.html"><a href="vectors.html"><i class="fa fa-check"></i><b>3</b> Vectors</a>
<ul>
<li class="chapter" data-level="3.1" data-path="vectors.html"><a href="vectors.html#introduction"><i class="fa fa-check"></i><b>3.1</b> Introduction</a></li>
<li class="chapter" data-level="3.2" data-path="vectors.html"><a href="vectors.html#atomic-vectors"><i class="fa fa-check"></i><b>3.2</b> Atomic vectors</a></li>
<li class="chapter" data-level="3.3" data-path="vectors.html"><a href="vectors.html#intro-vectors"><i class="fa fa-check"></i><b>3.3</b> Numeric vectors</a></li>
<li class="chapter" data-level="3.4" data-path="vectors.html"><a href="vectors.html#constructing-numeric-vectors"><i class="fa fa-check"></i><b>3.4</b> Constructing numeric vectors</a></li>
<li class="chapter" data-level="3.5" data-path="vectors.html"><a href="vectors.html#named-vectors"><i class="fa fa-check"></i><b>3.5</b> Named vectors</a></li>
<li class="chapter" data-level="3.6" data-path="vectors.html"><a href="vectors.html#vectorised-operations"><i class="fa fa-check"></i><b>3.6</b> Vectorised operations</a></li>
<li class="chapter" data-level="3.7" data-path="vectors.html"><a href="vectors.html#other-vectors"><i class="fa fa-check"></i><b>3.7</b> Other kinds of atomic vectors</a>
<ul>
<li class="chapter" data-level="3.7.1" data-path="vectors.html"><a href="vectors.html#character-vectors"><i class="fa fa-check"></i><b>3.7.1</b> Character vectors</a></li>
<li class="chapter" data-level="3.7.2" data-path="vectors.html"><a href="vectors.html#logical-vectors"><i class="fa fa-check"></i><b>3.7.2</b> Logical vectors</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="chapter-data-frames.html"><a href="chapter-data-frames.html"><i class="fa fa-check"></i><b>4</b> Data frames</a>
<ul>
<li class="chapter" data-level="4.1" data-path="chapter-data-frames.html"><a href="chapter-data-frames.html#introduction-1"><i class="fa fa-check"></i><b>4.1</b> Introduction</a></li>
<li class="chapter" data-level="4.2" data-path="chapter-data-frames.html"><a href="chapter-data-frames.html#data-frames-intro"><i class="fa fa-check"></i><b>4.2</b> Data frames</a></li>
<li class="chapter" data-level="4.3" data-path="chapter-data-frames.html"><a href="chapter-data-frames.html#exploring-data-frames"><i class="fa fa-check"></i><b>4.3</b> Exploring data frames</a></li>
<li class="chapter" data-level="4.4" data-path="chapter-data-frames.html"><a href="chapter-data-frames.html#extracting-and-adding-a-single-variable"><i class="fa fa-check"></i><b>4.4</b> Extracting and adding a single variable</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="packages.html"><a href="packages.html"><i class="fa fa-check"></i><b>5</b> Packages</a>
<ul>
<li class="chapter" data-level="5.1" data-path="packages.html"><a href="packages.html#package-system"><i class="fa fa-check"></i><b>5.1</b> The R package system</a></li>
<li class="chapter" data-level="5.2" data-path="packages.html"><a href="packages.html#task-views"><i class="fa fa-check"></i><b>5.2</b> Task views</a></li>
<li class="chapter" data-level="5.3" data-path="packages.html"><a href="packages.html#use-packages"><i class="fa fa-check"></i><b>5.3</b> Using packages</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="packages.html"><a href="packages.html#viewing-installed-packages"><i class="fa fa-check"></i><b>5.3.1</b> Viewing installed packages</a></li>
<li class="chapter" data-level="5.3.2" data-path="packages.html"><a href="packages.html#installing-packages"><i class="fa fa-check"></i><b>5.3.2</b> Installing packages</a></li>
<li class="chapter" data-level="5.3.3" data-path="packages.html"><a href="packages.html#loading-and-attaching-packages"><i class="fa fa-check"></i><b>5.3.3</b> Loading and attaching packages</a></li>
<li class="chapter" data-level="5.3.4" data-path="packages.html"><a href="packages.html#dont-use-rstudio-for-loading-packages"><i class="fa fa-check"></i><b>5.3.4</b> Don’t use RStudio for loading packages!</a></li>
<li class="chapter" data-level="5.3.5" data-path="packages.html"><a href="packages.html#an-analogy"><i class="fa fa-check"></i><b>5.3.5</b> An analogy</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="packages.html"><a href="packages.html#package-data"><i class="fa fa-check"></i><b>5.4</b> Package data</a></li>
<li class="chapter" data-level="5.5" data-path="packages.html"><a href="packages.html#the-tidyverse-ecosystem-of-packages"><i class="fa fa-check"></i><b>5.5</b> The tidyverse ecosystem of packages</a></li>
</ul></li>
<li class="part"><span><b>II Data Wrangling</b></span></li>
<li class="chapter" data-level="6" data-path="getting-ready-to-use-dplyr.html"><a href="getting-ready-to-use-dplyr.html"><i class="fa fa-check"></i><b>6</b> Getting ready to use <strong>dplyr</strong></a>
<ul>
<li class="chapter" data-level="6.1" data-path="getting-ready-to-use-dplyr.html"><a href="getting-ready-to-use-dplyr.html#introduction-2"><i class="fa fa-check"></i><b>6.1</b> Introduction</a></li>
<li class="chapter" data-level="6.2" data-path="getting-ready-to-use-dplyr.html"><a href="getting-ready-to-use-dplyr.html#tidy-data"><i class="fa fa-check"></i><b>6.2</b> Tidy data</a></li>
<li class="chapter" data-level="6.3" data-path="getting-ready-to-use-dplyr.html"><a href="getting-ready-to-use-dplyr.html#penguins-data-overview"><i class="fa fa-check"></i><b>6.3</b> Penguins! 🐧+📊= 😃</a></li>
<li class="chapter" data-level="6.4" data-path="getting-ready-to-use-dplyr.html"><a href="getting-ready-to-use-dplyr.html#um-tibbles"><i class="fa fa-check"></i><b>6.4</b> Um… tibbles?</a></li>
<li class="chapter" data-level="6.5" data-path="getting-ready-to-use-dplyr.html"><a href="getting-ready-to-use-dplyr.html#missing-values"><i class="fa fa-check"></i><b>6.5</b> Missing values</a></li>
<li class="chapter" data-level="6.6" data-path="getting-ready-to-use-dplyr.html"><a href="getting-ready-to-use-dplyr.html#why-dplyr"><i class="fa fa-check"></i><b>6.6</b> Introducing <strong>dplyr</strong></a>
<ul>
<li class="chapter" data-level="6.6.1" data-path="getting-ready-to-use-dplyr.html"><a href="getting-ready-to-use-dplyr.html#more-dplyr"><i class="fa fa-check"></i><b>6.6.1</b> A first look at <strong>dplyr</strong></a></li>
<li class="chapter" data-level="6.6.2" data-path="getting-ready-to-use-dplyr.html"><a href="getting-ready-to-use-dplyr.html#dplyr-pseudocode"><i class="fa fa-check"></i><b>6.6.2</b> <strong>dplyr</strong> pseudocode</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="working-with-variables.html"><a href="working-with-variables.html"><i class="fa fa-check"></i><b>7</b> Working with variables</a>
<ul>
<li class="chapter" data-level="7.1" data-path="working-with-variables.html"><a href="working-with-variables.html#introduction-3"><i class="fa fa-check"></i><b>7.1</b> Introduction</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="working-with-variables.html"><a href="working-with-variables.html#getting-ready"><i class="fa fa-check"></i><b>7.1.1</b> Getting ready</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="working-with-variables.html"><a href="working-with-variables.html#subset-variables-with-select"><i class="fa fa-check"></i><b>7.2</b> Subset variables with <code>select</code></a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="working-with-variables.html"><a href="working-with-variables.html#alternative-ways-to-identify-variables-with-select"><i class="fa fa-check"></i><b>7.2.1</b> Alternative ways to identify variables with <code>select</code></a></li>
<li class="chapter" data-level="7.2.2" data-path="working-with-variables.html"><a href="working-with-variables.html#renaming-variables-with-select-and-rename"><i class="fa fa-check"></i><b>7.2.2</b> Renaming variables with <code>select</code> and <code>rename</code></a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="working-with-variables.html"><a href="working-with-variables.html#creating-variables-with-mutate"><i class="fa fa-check"></i><b>7.3</b> Creating variables with <code>mutate</code></a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="working-with-variables.html"><a href="working-with-variables.html#transforming-and-dropping-variables"><i class="fa fa-check"></i><b>7.3.1</b> Transforming and dropping variables</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="working-with-observations.html"><a href="working-with-observations.html"><i class="fa fa-check"></i><b>8</b> Working with observations</a>
<ul>
<li class="chapter" data-level="8.1" data-path="working-with-observations.html"><a href="working-with-observations.html#introduction-4"><i class="fa fa-check"></i><b>8.1</b> Introduction</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="working-with-observations.html"><a href="working-with-observations.html#getting-ready-1"><i class="fa fa-check"></i><b>8.1.1</b> Getting ready</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="working-with-observations.html"><a href="working-with-observations.html#relational-and-logical-operators"><i class="fa fa-check"></i><b>8.2</b> Relational and logical operators</a></li>
<li class="chapter" data-level="8.3" data-path="working-with-observations.html"><a href="working-with-observations.html#subset-observations-with-filter"><i class="fa fa-check"></i><b>8.3</b> Subset observations with <code>filter</code></a></li>
<li class="chapter" data-level="8.4" data-path="working-with-observations.html"><a href="working-with-observations.html#reordering-observations-with-arrange"><i class="fa fa-check"></i><b>8.4</b> Reordering observations with <code>arrange</code></a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="summarising-and-grouping.html"><a href="summarising-and-grouping.html"><i class="fa fa-check"></i><b>9</b> Summarising and grouping</a>
<ul>
<li class="chapter" data-level="9.1" data-path="summarising-and-grouping.html"><a href="summarising-and-grouping.html#summarising-variables-with-summarise"><i class="fa fa-check"></i><b>9.1</b> Summarising variables with <code>summarise</code></a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="summarising-and-grouping.html"><a href="summarising-and-grouping.html#more-complicated-calculations-with-summarise"><i class="fa fa-check"></i><b>9.1.1</b> More complicated calculations with <code>summarise</code></a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="summarising-and-grouping.html"><a href="summarising-and-grouping.html#grouped-operations-using-group_by"><i class="fa fa-check"></i><b>9.2</b> Grouped operations using <code>group_by</code></a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="summarising-and-grouping.html"><a href="summarising-and-grouping.html#more-than-one-grouping-variable"><i class="fa fa-check"></i><b>9.2.1</b> More than one grouping variable</a></li>
<li class="chapter" data-level="9.2.2" data-path="summarising-and-grouping.html"><a href="summarising-and-grouping.html#using-group_by-with-other-verbs"><i class="fa fa-check"></i><b>9.2.2</b> Using <code>group_by</code> with other verbs</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="summarising-and-grouping.html"><a href="summarising-and-grouping.html#removing-grouping-information"><i class="fa fa-check"></i><b>9.3</b> Removing grouping information</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="building-pipelines.html"><a href="building-pipelines.html"><i class="fa fa-check"></i><b>10</b> Building pipelines</a>
<ul>
<li class="chapter" data-level="10.1" data-path="building-pipelines.html"><a href="building-pipelines.html#why-do-we-need-pipes"><i class="fa fa-check"></i><b>10.1</b> Why do we need ‘pipes?’</a></li>
<li class="chapter" data-level="10.2" data-path="building-pipelines.html"><a href="building-pipelines.html#using-pipes"><i class="fa fa-check"></i><b>10.2</b> Using pipes (<code>%&gt;%</code>)</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="helper-functions.html"><a href="helper-functions.html"><i class="fa fa-check"></i><b>11</b> Helper functions</a>
<ul>
<li class="chapter" data-level="11.1" data-path="helper-functions.html"><a href="helper-functions.html#introduction-5"><i class="fa fa-check"></i><b>11.1</b> Introduction</a></li>
<li class="chapter" data-level="11.2" data-path="helper-functions.html"><a href="helper-functions.html#working-with-select"><i class="fa fa-check"></i><b>11.2</b> Working with <code>select</code></a></li>
<li class="chapter" data-level="11.3" data-path="helper-functions.html"><a href="helper-functions.html#working-with-mutate-and-transmute"><i class="fa fa-check"></i><b>11.3</b> Working with <code>mutate</code> and <code>transmute</code></a></li>
<li class="chapter" data-level="11.4" data-path="helper-functions.html"><a href="helper-functions.html#working-with-filter"><i class="fa fa-check"></i><b>11.4</b> Working with <code>filter</code></a></li>
<li class="chapter" data-level="11.5" data-path="helper-functions.html"><a href="helper-functions.html#working-with-summarise"><i class="fa fa-check"></i><b>11.5</b> Working with <code>summarise</code></a></li>
</ul></li>
<li class="part"><span><b>III Exporing Data</b></span></li>
<li class="chapter" data-level="12" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html"><i class="fa fa-check"></i><b>12</b> Exploratory data analysis</a>
<ul>
<li class="chapter" data-level="12.1" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#introduction-6"><i class="fa fa-check"></i><b>12.1</b> Introduction</a></li>
<li class="chapter" data-level="12.2" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#variables"><i class="fa fa-check"></i><b>12.2</b> Statistical variables and data</a>
<ul>
<li class="chapter" data-level="12.2.1" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#numeric-vs-categorical-variables"><i class="fa fa-check"></i><b>12.2.1</b> Numeric vs categorical variables</a></li>
<li class="chapter" data-level="12.2.2" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#ratio-vs-interval-scales"><i class="fa fa-check"></i><b>12.2.2</b> Ratio vs interval scales</a></li>
</ul></li>
<li class="chapter" data-level="12.3" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#populations-samples"><i class="fa fa-check"></i><b>12.3</b> Populations and samples</a>
<ul>
<li class="chapter" data-level="12.3.1" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#sample-distributions"><i class="fa fa-check"></i><b>12.3.1</b> Sample distributions</a></li>
<li class="chapter" data-level="12.3.2" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#associations"><i class="fa fa-check"></i><b>12.3.2</b> Associations</a></li>
</ul></li>
<li class="chapter" data-level="12.4" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#types-of-eda"><i class="fa fa-check"></i><b>12.4</b> Types of EDA</a></li>
<li class="chapter" data-level="12.5" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#a-primer-of-descriptive-statistics"><i class="fa fa-check"></i><b>12.5</b> A primer of descriptive statistics</a>
<ul>
<li class="chapter" data-level="12.5.1" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#numeric-variables"><i class="fa fa-check"></i><b>12.5.1</b> Numeric variables</a></li>
<li class="chapter" data-level="12.5.2" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#categorical-variables"><i class="fa fa-check"></i><b>12.5.2</b> Categorical variables</a></li>
<li class="chapter" data-level="12.5.3" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#associations-1"><i class="fa fa-check"></i><b>12.5.3</b> Associations</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="13" data-path="chapter-ggplot2-intro.html"><a href="chapter-ggplot2-intro.html"><i class="fa fa-check"></i><b>13</b> Introduction to <strong>ggplot2</strong></a>
<ul>
<li class="chapter" data-level="13.1" data-path="chapter-ggplot2-intro.html"><a href="chapter-ggplot2-intro.html#anatomy"><i class="fa fa-check"></i><b>13.1</b> The anatomy of ggplot2</a>
<ul>
<li class="chapter" data-level="13.1.1" data-path="chapter-ggplot2-intro.html"><a href="chapter-ggplot2-intro.html#layers"><i class="fa fa-check"></i><b>13.1.1</b> Layers</a></li>
<li class="chapter" data-level="13.1.2" data-path="chapter-ggplot2-intro.html"><a href="chapter-ggplot2-intro.html#scales"><i class="fa fa-check"></i><b>13.1.2</b> Scales</a></li>
<li class="chapter" data-level="13.1.3" data-path="chapter-ggplot2-intro.html"><a href="chapter-ggplot2-intro.html#coordinate-system"><i class="fa fa-check"></i><b>13.1.3</b> Coordinate system</a></li>
<li class="chapter" data-level="13.1.4" data-path="chapter-ggplot2-intro.html"><a href="chapter-ggplot2-intro.html#faceting"><i class="fa fa-check"></i><b>13.1.4</b> Faceting</a></li>
</ul></li>
<li class="chapter" data-level="13.2" data-path="chapter-ggplot2-intro.html"><a href="chapter-ggplot2-intro.html#quick"><i class="fa fa-check"></i><b>13.2</b> A quick introduction to ggplot2</a>
<ul>
<li class="chapter" data-level="13.2.1" data-path="chapter-ggplot2-intro.html"><a href="chapter-ggplot2-intro.html#making-a-start"><i class="fa fa-check"></i><b>13.2.1</b> Making a start</a></li>
</ul></li>
<li class="chapter" data-level="13.3" data-path="chapter-ggplot2-intro.html"><a href="chapter-ggplot2-intro.html#a-standard-way-of-using-ggplot2"><i class="fa fa-check"></i><b>13.3</b> A standard way of using <strong>ggplot2</strong></a>
<ul>
<li class="chapter" data-level="13.3.1" data-path="chapter-ggplot2-intro.html"><a href="chapter-ggplot2-intro.html#how-should-we-format-ggplot2-code"><i class="fa fa-check"></i><b>13.3.1</b> How should we format <strong>ggplot2</strong> code?</a></li>
</ul></li>
<li class="chapter" data-level="13.4" data-path="chapter-ggplot2-intro.html"><a href="chapter-ggplot2-intro.html#increasing-the-information-density"><i class="fa fa-check"></i><b>13.4</b> Increasing the information density…</a>
<ul>
<li class="chapter" data-level="13.4.1" data-path="chapter-ggplot2-intro.html"><a href="chapter-ggplot2-intro.html#via-aesthetic-mappings"><i class="fa fa-check"></i><b>13.4.1</b> …via aesthetic mappings</a></li>
<li class="chapter" data-level="13.4.2" data-path="chapter-ggplot2-intro.html"><a href="chapter-ggplot2-intro.html#via-facets"><i class="fa fa-check"></i><b>13.4.2</b> …via facets</a></li>
<li class="chapter" data-level="13.4.3" data-path="chapter-ggplot2-intro.html"><a href="chapter-ggplot2-intro.html#via-multiple-layers"><i class="fa fa-check"></i><b>13.4.3</b> …via multiple layers</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="14" data-path="chapter-customise-ggplot2.html"><a href="chapter-customise-ggplot2.html"><i class="fa fa-check"></i><b>14</b> Customising plots</a>
<ul>
<li class="chapter" data-level="14.1" data-path="chapter-customise-ggplot2.html"><a href="chapter-customise-ggplot2.html#geom-properties"><i class="fa fa-check"></i><b>14.1</b> Geom properties</a>
<ul>
<li class="chapter" data-level="14.1.1" data-path="chapter-customise-ggplot2.html"><a href="chapter-customise-ggplot2.html#relationship-between-aesthetic-mappings-and-geom-properties"><i class="fa fa-check"></i><b>14.1.1</b> Relationship between aesthetic mappings and geom properties</a></li>
</ul></li>
<li class="chapter" data-level="14.2" data-path="chapter-customise-ggplot2.html"><a href="chapter-customise-ggplot2.html#plot-scales"><i class="fa fa-check"></i><b>14.2</b> Plot scales</a></li>
<li class="chapter" data-level="14.3" data-path="chapter-customise-ggplot2.html"><a href="chapter-customise-ggplot2.html#labels"><i class="fa fa-check"></i><b>14.3</b> Labels</a></li>
<li class="chapter" data-level="14.4" data-path="chapter-customise-ggplot2.html"><a href="chapter-customise-ggplot2.html#themes"><i class="fa fa-check"></i><b>14.4</b> Themes</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="exploring-one-variable.html"><a href="exploring-one-variable.html"><i class="fa fa-check"></i><b>15</b> Exploring one variable</a>
<ul>
<li class="chapter" data-level="15.1" data-path="exploring-one-variable.html"><a href="exploring-one-variable.html#explore-numeric"><i class="fa fa-check"></i><b>15.1</b> Exploring numerical variables</a>
<ul>
<li class="chapter" data-level="15.1.1" data-path="exploring-one-variable.html"><a href="exploring-one-variable.html#what-kind-of-numeric-variable"><i class="fa fa-check"></i><b>15.1.1</b> What kind of numeric variable?</a></li>
<li class="chapter" data-level="15.1.2" data-path="exploring-one-variable.html"><a href="exploring-one-variable.html#histograms"><i class="fa fa-check"></i><b>15.1.2</b> Histograms</a></li>
<li class="chapter" data-level="15.1.3" data-path="exploring-one-variable.html"><a href="exploring-one-variable.html#dot-plots"><i class="fa fa-check"></i><b>15.1.3</b> Dot plots</a></li>
</ul></li>
<li class="chapter" data-level="15.2" data-path="exploring-one-variable.html"><a href="exploring-one-variable.html#explore-categorical"><i class="fa fa-check"></i><b>15.2</b> Exploring categorical variables</a>
<ul>
<li class="chapter" data-level="15.2.1" data-path="exploring-one-variable.html"><a href="exploring-one-variable.html#what-kind-of-categorical-variable"><i class="fa fa-check"></i><b>15.2.1</b> What kind of categorical variable?</a></li>
<li class="chapter" data-level="15.2.2" data-path="exploring-one-variable.html"><a href="exploring-one-variable.html#bar-plots"><i class="fa fa-check"></i><b>15.2.2</b> Bar plots</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="16" data-path="exploring-associations.html"><a href="exploring-associations.html"><i class="fa fa-check"></i><b>16</b> Exploring associations</a>
<ul>
<li class="chapter" data-level="16.1" data-path="exploring-associations.html"><a href="exploring-associations.html#numeric-association"><i class="fa fa-check"></i><b>16.1</b> Associations between numeric variables</a></li>
<li class="chapter" data-level="16.2" data-path="exploring-associations.html"><a href="exploring-associations.html#categorical-association"><i class="fa fa-check"></i><b>16.2</b> Associations between categorical variables</a></li>
<li class="chapter" data-level="16.3" data-path="exploring-associations.html"><a href="exploring-associations.html#cat-num-association"><i class="fa fa-check"></i><b>16.3</b> Categorical-numerical associations</a>
<ul>
<li class="chapter" data-level="16.3.1" data-path="exploring-associations.html"><a href="exploring-associations.html#alternatives-to-box-and-whiskers-plots"><i class="fa fa-check"></i><b>16.3.1</b> Alternatives to box and whiskers plots</a></li>
</ul></li>
<li class="chapter" data-level="16.4" data-path="exploring-associations.html"><a href="exploring-associations.html#multivariate"><i class="fa fa-check"></i><b>16.4</b> Multivariate associations</a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="doing-more-with-ggplot2.html"><a href="doing-more-with-ggplot2.html"><i class="fa fa-check"></i><b>17</b> Doing more with <strong>ggplot2</strong></a>
<ul>
<li class="chapter" data-level="17.1" data-path="doing-more-with-ggplot2.html"><a href="doing-more-with-ggplot2.html#summaries"><i class="fa fa-check"></i><b>17.1</b> Comparing descriptive statistics</a>
<ul>
<li class="chapter" data-level="17.1.1" data-path="doing-more-with-ggplot2.html"><a href="doing-more-with-ggplot2.html#error-bars"><i class="fa fa-check"></i><b>17.1.1</b> Error bars</a></li>
<li class="chapter" data-level="17.1.2" data-path="doing-more-with-ggplot2.html"><a href="doing-more-with-ggplot2.html#alternatives-to-bar-plots"><i class="fa fa-check"></i><b>17.1.2</b> Alternatives to bar plots</a></li>
</ul></li>
<li class="chapter" data-level="17.2" data-path="doing-more-with-ggplot2.html"><a href="doing-more-with-ggplot2.html#adding-text-annotations"><i class="fa fa-check"></i><b>17.2</b> Adding text annotations</a></li>
<li class="chapter" data-level="17.3" data-path="doing-more-with-ggplot2.html"><a href="doing-more-with-ggplot2.html#saving-plots"><i class="fa fa-check"></i><b>17.3</b> Saving plots</a></li>
<li class="chapter" data-level="17.4" data-path="doing-more-with-ggplot2.html"><a href="doing-more-with-ggplot2.html#multi-panel-plots"><i class="fa fa-check"></i><b>17.4</b> Multi-panel plots</a></li>
</ul></li>
<li class="appendix"><span><b>Supplementary Material</b></span></li>
<li class="chapter" data-level="A" data-path="getting-help.html"><a href="getting-help.html"><i class="fa fa-check"></i><b>A</b> Getting help</a>
<ul>
<li class="chapter" data-level="A.1" data-path="getting-help.html"><a href="getting-help.html#console-help"><i class="fa fa-check"></i><b>A.1</b> Introduction</a></li>
<li class="chapter" data-level="A.2" data-path="getting-help.html"><a href="getting-help.html#browsing-the-help-system"><i class="fa fa-check"></i><b>A.2</b> Browsing the help system</a></li>
<li class="chapter" data-level="A.3" data-path="getting-help.html"><a href="getting-help.html#searching-for-help-files"><i class="fa fa-check"></i><b>A.3</b> Searching for help files</a></li>
<li class="chapter" data-level="A.4" data-path="getting-help.html"><a href="getting-help.html#nav-help"><i class="fa fa-check"></i><b>A.4</b> Navigating help files</a></li>
<li class="chapter" data-level="A.5" data-path="getting-help.html"><a href="getting-help.html#vignettes"><i class="fa fa-check"></i><b>A.5</b> Vignettes and demos</a></li>
</ul></li>
<li class="chapter" data-level="B" data-path="project-scripts-data.html"><a href="project-scripts-data.html"><i class="fa fa-check"></i><b>B</b> Managing projects, scripts and data files</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Exploratory Data Analysis with R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="exploring-associations" class="section level1" number="16">
<h1><span class="header-section-number">Chapter 16</span> Exploring associations</h1>
<p>A pair of variables are said to be associated when knowing the value of one variable gives us information about the possible values of another. This chapter’s main goal is to show how to use visualisations to explore associations among different kinds of variables.</p>
<div id="numeric-association" class="section level2" number="16.1">
<h2><span class="header-section-number">16.1</span> Associations between numeric variables</h2>
<p>The standard graph for displaying an association among a pair of numeric variables is the scatter plot. This uses horizontal and vertical axes to show two variables as a series of points. We saw how to construct a scatter plot in the <a href="chapter-ggplot2-intro.html#chapter-ggplot2-intro">Introduction to ggplot2</a> chapter. Here is the initial plot we made to show the association between bill depth and bill length (ignoring species information):</p>
<div class="sourceCode" id="cb380"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb380-1"><a href="exploring-associations.html#cb380-1" aria-hidden="true" tabindex="-1"></a><span class="co"># display bill morphology scatter plot</span></span>
<span id="cb380-2"><a href="exploring-associations.html#cb380-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(penguins,</span>
<span id="cb380-3"><a href="exploring-associations.html#cb380-3" aria-hidden="true" tabindex="-1"></a>       <span class="co"># aesthetic mappings: bill depth (y) vs bill length (x)</span></span>
<span id="cb380-4"><a href="exploring-associations.html#cb380-4" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> bill_length_mm, <span class="at">y =</span> bill_depth_mm)) <span class="sc">+</span> </span>
<span id="cb380-5"><a href="exploring-associations.html#cb380-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># geom_point to add points layer</span></span>
<span id="cb380-6"><a href="exploring-associations.html#cb380-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span></code></pre></div>
<p><img src="intro-bio-data-book_files/figure-html/unnamed-chunk-242-1.png" width="336" style="display: block; margin: auto;" /></p>
<p>Most of the time, a scatter plot is exactly the right plot for visualising an association among numeric variables. One limitation of scatter plots is that they tend not to reveal associations when there is a lot of over-plotting happening. This occurs when:</p>
<ol style="list-style-type: decimal">
<li>there is a lot of data (e.g. 1000s of data points), meaning the distance between points is very small; or</li>
<li>there are many identical pairs of values, typically because both variables are discrete or a continuous variable is measured on a coarse scale.</li>
</ol>
<p>In these circumstances, over-plotting of points tends to obscure the association. Sometimes we can mitigate this by making the points very small (problem #1) or semi-transparent (problem #1 or #2). But what should we do when those sorts of tricks fail to improve a plot? Luckily, <strong>ggplot2</strong> provides alternative geoms for visualising numeric associations in situations where over-plotting is a problem.</p>
<p>Two options for dealing with large data sets (problem #1) are the <code>geom_bin_2d</code> and <code>geom_hex</code> functions. These work like histograms in two dimensions. The <code>geom_bin_2d</code> divides the plane into rectangles, counts the number of cases in each rectangle, and then uses the number of cases to assign the rectangle’s fill colour. The <code>geom_hex</code> function does essentially the same thing but instead divides the plane into regular hexagons.</p>
<p>Here’s an example of <code>geom_hex</code> in action (n.b. <code>geom_hex</code> relies on the <strong>hexbin</strong> package, so this need to be installed to use it):</p>
<div class="sourceCode" id="cb381"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb381-1"><a href="exploring-associations.html#cb381-1" aria-hidden="true" tabindex="-1"></a><span class="co"># display bill morphology scatter plot</span></span>
<span id="cb381-2"><a href="exploring-associations.html#cb381-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(penguins,</span>
<span id="cb381-3"><a href="exploring-associations.html#cb381-3" aria-hidden="true" tabindex="-1"></a>       <span class="co"># aesthetic mappings: bill depth (y) vs bill length (x)</span></span>
<span id="cb381-4"><a href="exploring-associations.html#cb381-4" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> bill_length_mm, <span class="at">y =</span> bill_depth_mm)) <span class="sc">+</span> </span>
<span id="cb381-5"><a href="exploring-associations.html#cb381-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># add shaded hex bin layer</span></span>
<span id="cb381-6"><a href="exploring-associations.html#cb381-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hex</span>(<span class="at">bins =</span> <span class="dv">12</span>)</span></code></pre></div>
<p><img src="intro-bio-data-book_files/figure-html/unnamed-chunk-243-1.png" width="432" style="display: block; margin: auto;" /></p>
<p>The bins argument controls how many hexagonal bins to use when spanning each dimension. The <code>penguins</code> data set is a bit small for this kind of plot (a scatter plot is actually better), so we had to use relatively coarse binning by setting the number of bins to 12.</p>
<p>Notice how similar this looks to the <strong>ggplot2</strong> code for a scatter plot. We simply used <code>geom_hex</code> in place of <code>geom_point</code>. This reveals a powerful feature of <strong>ggplot2</strong>—once we have a working plot, we can often switch to a reasonable alternative by simply changing the type of geom. This makes it very quick to explore a data set in different ways.</p>
<p>What should we do if there are there are many identical pairs of values? For example, imagine that bill length had only been measured to the nearest 2 mm and bill depth had only been measured to the nearest 1 mm, like this:</p>
<pre><code>## # A tibble: 344 x 2
##    bill_length_mm bill_depth_mm
##             &lt;dbl&gt;         &lt;dbl&gt;
##  1             40            19
##  2             40            17
##  3             40            18
##  4             NA            NA
##  5             36            19
##  6             40            21
##  7             38            18
##  8             40            20
##  9             34            18
## 10             42            20
## # … with 334 more rows</code></pre>
<p>A scatter plot <code>bill_depth_mm</code> against <code>bill_length_mm</code> produced with those coarsened data would look like this:</p>
<p><img src="intro-bio-data-book_files/figure-html/unnamed-chunk-245-1.png" width="336" style="display: block; margin: auto;" /></p>
<p>This is not very informative because groups of points appear in exactly the same x/y location.</p>
<p>The <code>geom_count</code> function solves this problem by producing a scatter plot where point sizes are scaled according to how many cases are associated with each point. For example, the following code produces a modified scatter plot using a coarsened bill morphology data set (called <code>penguins_coarse</code>):</p>
<div class="sourceCode" id="cb383"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb383-1"><a href="exploring-associations.html#cb383-1" aria-hidden="true" tabindex="-1"></a><span class="co"># display coarsened bill morphology scatter plot</span></span>
<span id="cb383-2"><a href="exploring-associations.html#cb383-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(penguins_coarse,</span>
<span id="cb383-3"><a href="exploring-associations.html#cb383-3" aria-hidden="true" tabindex="-1"></a>       <span class="co"># aesthetic mappings: bill depth (y) vs bill length (x)</span></span>
<span id="cb383-4"><a href="exploring-associations.html#cb383-4" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> bill_length_mm, <span class="at">y =</span> bill_depth_mm)) <span class="sc">+</span> </span>
<span id="cb383-5"><a href="exploring-associations.html#cb383-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># use geom_count to add sample size scaled points layer</span></span>
<span id="cb383-6"><a href="exploring-associations.html#cb383-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_count</span>()</span></code></pre></div>
<p><img src="intro-bio-data-book_files/figure-html/unnamed-chunk-246-1.png" width="432" style="display: block; margin: auto;" /></p>
<p>Again, notice how similar this looks to the <strong>ggplot2</strong> code for a standard scatter plot. We simply used <code>geom_count</code> in place of <code>geom_point</code>.</p>
</div>
<div id="categorical-association" class="section level2" number="16.2">
<h2><span class="header-section-number">16.2</span> Associations between categorical variables</h2>
<p>Bar charts are often used to summarise associations between categorical variables. The basic idea is to produce a separate bar for <em>each combination</em> of categories in the two variables. The lengths of each bar is proportional to the value it represents, which is either a raw count or the proportion in each category combination.</p>
<p>Using <strong>ggplot2</strong> to display this information is not very different from producing a bar graph to summarise a single categorical variable. Let’s do this for the <code>species</code> and <code>year</code> variables in <code>penguins</code>:</p>
<div class="sourceCode" id="cb384"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb384-1"><a href="exploring-associations.html#cb384-1" aria-hidden="true" tabindex="-1"></a><span class="co"># display bar plot of year-species counts</span></span>
<span id="cb384-2"><a href="exploring-associations.html#cb384-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(penguins, </span>
<span id="cb384-3"><a href="exploring-associations.html#cb384-3" aria-hidden="true" tabindex="-1"></a>       <span class="co"># aesthetic mappings: year (x) by species (fill)</span></span>
<span id="cb384-4"><a href="exploring-associations.html#cb384-4" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">fill =</span> species)) <span class="sc">+</span></span>
<span id="cb384-5"><a href="exploring-associations.html#cb384-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># use geom_bar to add bar plot layer  with stacked bars</span></span>
<span id="cb384-6"><a href="exploring-associations.html#cb384-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>()</span></code></pre></div>
<p><img src="intro-bio-data-book_files/figure-html/unnamed-chunk-247-1.png" width="336" style="display: block; margin: auto;" /></p>
<p>We want to display information from two categorical variables, so we have to define two aesthetic mappings. We mapped the year variable (<code>year</code>) to the x axis and species (<code>species</code>) to the fill colour. Predictably, we construct the layer using <code>geom_bar</code>.</p>
<p>This produced a <strong>stacked bar chart</strong>. Each year has its own bar (<code>x = year</code>), and each bar has been divided up into different coloured segments, the length of which is determined by the number of observations associated with each species in that year (<code>fill = species</code>).</p>
<p>We have all the right information in this graph, but it could be improved in a couple of ways:</p>
<ul>
<li>Look at the guides on the x axis. There are some pointless extra lines. We saw this issue in a different guise in the previous chapter. It occurs because <code>year</code> is stored as a numeric vector—<strong>ggplot2</strong> has no way of knowing we want to treat it as a non-numeric, categorical variable.</li>
<li>The ordering of the species in the stacks does not reflect the relative frequency of each species. Again, we saw this problem in the previous chapter—<strong>ggplot2</strong> treats does not ‘know’ how we want to order the <code>species</code> categories, and so it uses alphabetical order.</li>
</ul>
<p>We need to ensure <code>year</code> is interpreted as a categorical variable and provide information about the required category order of <code>species</code>. R has a special kind of vector, called a <strong>factor</strong>, that is designed to tackle these kinds of issues. Factors are used by R to represent categorical variables.</p>
<p>We need to convert <code>year</code> and <code>species</code> to factors. How do we convert a numeric or character vector into a factor? Use the <code>factor</code> function (this is the first time we’ve mentioned this function). This has an argument called <code>levels</code> that sets the allowed categories and their order.</p>
<p>One way to start is by setting up a character vector of species names <strong>in the required order</strong> (<code>species_names</code>):</p>
<div class="sourceCode" id="cb385"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb385-1"><a href="exploring-associations.html#cb385-1" aria-hidden="true" tabindex="-1"></a><span class="co"># levels of new species factor **in required order**</span></span>
<span id="cb385-2"><a href="exploring-associations.html#cb385-2" aria-hidden="true" tabindex="-1"></a>species_names <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Chinstrap&quot;</span>, <span class="st">&quot;Gentoo&quot;</span>, <span class="st">&quot;Adelie&quot;</span>)</span></code></pre></div>
<p>We supplied the names in the order we want them to appear. Be careful with the spelling—the values of <code>species_names</code> have to match those used in <code>species</code>. We can now remake the bar plot, this time converting <code>species</code> and <code>year</code> to factors ‘on the fly’:</p>
<div class="sourceCode" id="cb386"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb386-1"><a href="exploring-associations.html#cb386-1" aria-hidden="true" tabindex="-1"></a><span class="co"># display bar plot of year-species counts</span></span>
<span id="cb386-2"><a href="exploring-associations.html#cb386-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(penguins, </span>
<span id="cb386-3"><a href="exploring-associations.html#cb386-3" aria-hidden="true" tabindex="-1"></a>       <span class="co"># aesthetic mappings: year (x) by species (fill) AND convert to factor</span></span>
<span id="cb386-4"><a href="exploring-associations.html#cb386-4" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">factor</span>(year), <span class="at">fill =</span> <span class="fu">factor</span>(species, <span class="at">levels =</span> species_names))) <span class="sc">+</span></span>
<span id="cb386-5"><a href="exploring-associations.html#cb386-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># use geom_bar to add bar plot layer with stacked bars</span></span>
<span id="cb386-6"><a href="exploring-associations.html#cb386-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>()</span></code></pre></div>
<p><img src="intro-bio-data-book_files/figure-html/unnamed-chunk-249-1.png" width="480" style="display: block; margin: auto;" /></p>
<p>This uses <code>species_names</code> to set the levels of <code>species</code> when we convert it to a factor. The stacking order of the bars then reflects their order in <code>species_names</code>. There was no need to set the levels of <code>year</code> because R will use the numeric order by default. Yes… the labels in that plot are ugly, but we could easily change these using <code>labs</code> function if we wanted to.</p>
<div id="factors" class="section level4 unnumbered infobox warning">
<h4>Factors</h4>
<p>Factors are very useful and crop up all the time in R. A complete treatment of factors would require a whole new chapter. We’ve just shown one way to work with them via the <code>factor</code> function. This is enough to solve the reordering trick required to get <strong>ggplot2</strong> to work the way we want it to, but there’s a lot more to learn about factors. There is even a package (<strong>forcats</strong>) that exists solely to make working with factors a bit easier.</p>
<p>One thing to be aware of is that it is sometimes simpler to convert variables to factors in a data set, rather than doing it every time we use them with <strong>ggplot2</strong>. For example, we could use <code>mutate</code> to create factor versions of <code>year</code> and <code>species</code>:</p>
<div class="sourceCode" id="cb387"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb387-1"><a href="exploring-associations.html#cb387-1" aria-hidden="true" tabindex="-1"></a><span class="co"># convert year and species to factors to ensure correct ordering </span></span>
<span id="cb387-2"><a href="exploring-associations.html#cb387-2" aria-hidden="true" tabindex="-1"></a>penguins <span class="ot">&lt;-</span> penguins <span class="sc">%&gt;%</span> </span>
<span id="cb387-3"><a href="exploring-associations.html#cb387-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">year    =</span> <span class="fu">factor</span>(year),</span>
<span id="cb387-4"><a href="exploring-associations.html#cb387-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">species =</span> <span class="fu">factor</span>(species, <span class="at">levels =</span> species_names)) </span></code></pre></div>
<p>Any <strong>ggplot2</strong> code that uses the updated version of <code>penguins</code> would then automatically respect the intended categorical nature of <code>year</code> of and the <code>species</code> ordering we desire.</p>
</div>
<p>A stacked bar chart is the <code>geom_bar</code> default. If we want to know how two categorical variables are associated it is sometimes better to plot all bars side-by-side. This is not hard to do. We switch to a side-by-side bar chart by assigning a value of <code>"dodge"</code> to the <code>position</code> argument of <code>geom_bar</code>:</p>
<div class="sourceCode" id="cb388"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb388-1"><a href="exploring-associations.html#cb388-1" aria-hidden="true" tabindex="-1"></a><span class="co"># display bar plot of year-species counts</span></span>
<span id="cb388-2"><a href="exploring-associations.html#cb388-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(penguins, </span>
<span id="cb388-3"><a href="exploring-associations.html#cb388-3" aria-hidden="true" tabindex="-1"></a>       <span class="co"># aesthetic mappings: year (x) by species (fill) AND convert to factor</span></span>
<span id="cb388-4"><a href="exploring-associations.html#cb388-4" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">factor</span>(year), <span class="at">fill =</span> <span class="fu">factor</span>(species, <span class="at">levels =</span> species_names))) <span class="sc">+</span></span>
<span id="cb388-5"><a href="exploring-associations.html#cb388-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># use geom_bar to add bar plot layer with adjacent fill bars</span></span>
<span id="cb388-6"><a href="exploring-associations.html#cb388-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">position =</span> <span class="st">&quot;dodge&quot;</span>)</span></code></pre></div>
<p><img src="intro-bio-data-book_files/figure-html/unnamed-chunk-251-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>The <code>position = "dodge"</code> argument says that we want the bars to ‘dodge’ one another along the x axis. This slightly odd language is how <strong>ggplot2</strong> specifies the position of grouped items so they are displayed next to one another.</p>
<p>Remember—the customisation techniques introduced in the <a href="chapter-customise-ggplot2.html#chapter-customise-ggplot2">Customising plots</a> chapter are completely general. For example, we could improve the plot by using <code>labs</code> to set the labels, setting custom fill colours with <code>scale_fill_manual</code>, and applying a theme via <code>theme_minimal</code>:</p>
<div class="sourceCode" id="cb389"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb389-1"><a href="exploring-associations.html#cb389-1" aria-hidden="true" tabindex="-1"></a><span class="co"># display bar plot of year-species counts</span></span>
<span id="cb389-2"><a href="exploring-associations.html#cb389-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(penguins, </span>
<span id="cb389-3"><a href="exploring-associations.html#cb389-3" aria-hidden="true" tabindex="-1"></a>       <span class="co"># aesthetic mappings: year (x) by species (fill) AND convert to factor</span></span>
<span id="cb389-4"><a href="exploring-associations.html#cb389-4" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">factor</span>(year), <span class="at">fill =</span> <span class="fu">factor</span>(species, <span class="at">levels =</span> species_names))) <span class="sc">+</span></span>
<span id="cb389-5"><a href="exploring-associations.html#cb389-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># use geom_bar to add bar plot layer with fill bars next to one another</span></span>
<span id="cb389-6"><a href="exploring-associations.html#cb389-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">position =</span> <span class="st">&quot;dodge&quot;</span>) <span class="sc">+</span></span>
<span id="cb389-7"><a href="exploring-associations.html#cb389-7" aria-hidden="true" tabindex="-1"></a>  <span class="co"># customise fill colour scale</span></span>
<span id="cb389-8"><a href="exploring-associations.html#cb389-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;cornflowerblue&quot;</span>, <span class="st">&quot;seagreen&quot;</span>, <span class="st">&quot;orangered3&quot;</span>)) <span class="sc">+</span></span>
<span id="cb389-9"><a href="exploring-associations.html#cb389-9" aria-hidden="true" tabindex="-1"></a>  <span class="co"># specify labels for all mappings</span></span>
<span id="cb389-10"><a href="exploring-associations.html#cb389-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Year&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Number of cases&quot;</span>, <span class="at">fill =</span> <span class="st">&quot;Species&quot;</span>) <span class="sc">+</span></span>
<span id="cb389-11"><a href="exploring-associations.html#cb389-11" aria-hidden="true" tabindex="-1"></a>  <span class="co"># apply minimal theme</span></span>
<span id="cb389-12"><a href="exploring-associations.html#cb389-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code></pre></div>
<p><img src="intro-bio-data-book_files/figure-html/unnamed-chunk-252-1.png" width="528" style="display: block; margin: auto;" /></p>
</div>
<div id="cat-num-association" class="section level2" number="16.3">
<h2><span class="header-section-number">16.3</span> Categorical-numerical associations</h2>
<p>The next obvious question is, “How do we display the association between a categorical and numeric variable?” As usual, there are a range of different options.</p>
<p>The most common is the ‘box and whiskers plot’ (or just ‘box plot’). This is best understood by example. To construct a box and whiskers plot we need to set ‘x’ and ‘y’ axis aesthetics for the categorical and numeric variable; then use the <code>geom_boxplot</code> function to add the appropriate layer. To examine the association between penguin species (<code>species</code>) and body mass measurements (<code>body_mass_g</code>), use:</p>
<div class="sourceCode" id="cb390"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb390-1"><a href="exploring-associations.html#cb390-1" aria-hidden="true" tabindex="-1"></a><span class="co"># display box and whiskers plot of body mass for each species</span></span>
<span id="cb390-2"><a href="exploring-associations.html#cb390-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(penguins, </span>
<span id="cb390-3"><a href="exploring-associations.html#cb390-3" aria-hidden="true" tabindex="-1"></a>       <span class="co"># aesthetic mappings: body mass (y) vs species (x)</span></span>
<span id="cb390-4"><a href="exploring-associations.html#cb390-4" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> species, <span class="at">y =</span> body_mass_g)) <span class="sc">+</span></span>
<span id="cb390-5"><a href="exploring-associations.html#cb390-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># use geom_boxplot to add box plots layer</span></span>
<span id="cb390-6"><a href="exploring-associations.html#cb390-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span> </span>
<span id="cb390-7"><a href="exploring-associations.html#cb390-7" aria-hidden="true" tabindex="-1"></a>  <span class="co"># specify labels for x- and y-axes</span></span>
<span id="cb390-8"><a href="exploring-associations.html#cb390-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Species&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Body mass (g)&quot;</span>)</span></code></pre></div>
<p><img src="intro-bio-data-book_files/figure-html/unnamed-chunk-253-1.png" width="336" style="display: block; margin: auto;" /></p>
<p>We can see why this is called a box and whiskers plot. There are four components of each box and whiskers:</p>
<ul>
<li><p>The horizontal line inside the box is the sample median of the numeric variable—a measure of its central tendency. This allows us to compare the most likely value of the numeric variable across the different categories.</p></li>
<li><p>The boxes display the interquartile range (IQR) of the numeric variable in each category, i.e. the middle 50% of each group. This allows us to compare the spread (=dispersion) of the numeric values across categories.</p></li>
<li><p>The vertical lines above and below each box are the “whiskers.” The interpretation of these depends on which kind of box plot we are making. <strong>ggplot2</strong> produces a traditional Tukey box plot by default. Each whisker is drawn from each end of the box (the upper and lower quartiles) to a well-defined extreme point. To find where the upper whisker ends, we have to find the largest observation that is no more than 1.5 times the IQR above the upper quartile. The lower whisker ends at the most extreme point that is no more than 1.5 times the IQR below the lower quartile.</p></li>
<li><p>Any cases that do not fall inside the whiskers are plotted as an individual point. These may be outliers, although they could also be perfectly consistent with the wider distribution.</p></li>
</ul>
<p>The resulting plot compactly summarises the distribution of the numeric variable within categories. It provides information about the central tendency, dispersion and skewness of each distribution. We also get a sense of whether there are potential outliers by noting the presence of individual points outside the whiskers.</p>
<p>What does the above plot tell us about body mass and species? It shows the body mass distributions of Chinstrap and Adelie penguins are very similar, in terms of both central tendency and dispersion. In contrast, Gentoo penguins are generally larger and exhibit great absolute variation. The Gentoo body mass distribution is also the only one that seems to display much skew.</p>
<div id="alternatives-to-box-and-whiskers-plots" class="section level3" number="16.3.1">
<h3><span class="header-section-number">16.3.1</span> Alternatives to box and whiskers plots</h3>
<p>Box and whiskers plots are a good choice for exploring categorical-numerical associations. They provide a lot of information about how the distribution of the numeric variable changes across categories. Sometimes we may want to squeeze even more information about these distributions into a plot. One way to do this is to make multiple histograms.</p>
<p>We know how to make a histogram, and we have seen how aesthetic properties such as <code>colour</code> and <code>fill</code> are used to distinguish different categories of a variable. This suggests we could overlay more than one histogram on a single plot. Let’s use this idea to see how the sample distribution of body mass differs among the species again:</p>
<div class="sourceCode" id="cb391"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb391-1"><a href="exploring-associations.html#cb391-1" aria-hidden="true" tabindex="-1"></a><span class="co"># display histogram of body mass for each species in one plot</span></span>
<span id="cb391-2"><a href="exploring-associations.html#cb391-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(penguins, </span>
<span id="cb391-3"><a href="exploring-associations.html#cb391-3" aria-hidden="true" tabindex="-1"></a>       <span class="co"># aesthetic mappings: body mass (x) by species groups (fill)</span></span>
<span id="cb391-4"><a href="exploring-associations.html#cb391-4" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> body_mass_g, <span class="at">fill =</span> species))  <span class="sc">+</span></span>
<span id="cb391-5"><a href="exploring-associations.html#cb391-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># use geom_histogram to add histogram layer with customisation</span></span>
<span id="cb391-6"><a href="exploring-associations.html#cb391-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">position =</span> <span class="st">&quot;identity&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.8</span>, <span class="at">binwidth =</span> <span class="dv">200</span>) <span class="sc">+</span> </span>
<span id="cb391-7"><a href="exploring-associations.html#cb391-7" aria-hidden="true" tabindex="-1"></a>  <span class="co"># specify labels for all mappings</span></span>
<span id="cb391-8"><a href="exploring-associations.html#cb391-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Body mass (g)&quot;</span>, <span class="at">fill =</span> <span class="st">&quot;Species&quot;</span>)</span></code></pre></div>
<p><img src="intro-bio-data-book_files/figure-html/unnamed-chunk-254-1.png" width="528" style="display: block; margin: auto;" /></p>
<p>We defined two mappings: the continuous variable (<code>body_mass_g</code>) was mapped to the x axis and the categorical variable (<code>species</code>) was mapped to the fill colour. Notice that we also set the <code>position</code> argument to <code>"identity"</code>. This tells <strong>ggplot2</strong> not to stack the histograms on top of one another. Instead, they are allowed to overlap. It’s for this reason that we also made them semi-transparent by setting the <code>alpha</code> argument.</p>
<p>Plotting several histograms in one layer like this places a lot of information in one plot, but it can be hard to make sense of when the histograms overlap a lot. If the overlapping histograms are too difficult to interpret, we might consider producing a separate one for each category. We’ve already seen a quick way to do this. Faceting works well here:</p>
<div class="sourceCode" id="cb392"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb392-1"><a href="exploring-associations.html#cb392-1" aria-hidden="true" tabindex="-1"></a><span class="co"># display histogram of body mass for each species in separate panels</span></span>
<span id="cb392-2"><a href="exploring-associations.html#cb392-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(penguins,</span>
<span id="cb392-3"><a href="exploring-associations.html#cb392-3" aria-hidden="true" tabindex="-1"></a>       <span class="co"># aesthetic mappings: body mass (x) (only one!)</span></span>
<span id="cb392-4"><a href="exploring-associations.html#cb392-4" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> body_mass_g))  <span class="sc">+</span></span>
<span id="cb392-5"><a href="exploring-associations.html#cb392-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># use geom_histogram to add histogram layer with sensible bin width</span></span>
<span id="cb392-6"><a href="exploring-associations.html#cb392-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="dv">200</span>) <span class="sc">+</span> </span>
<span id="cb392-7"><a href="exploring-associations.html#cb392-7" aria-hidden="true" tabindex="-1"></a>  <span class="co"># specify label for x-axis</span></span>
<span id="cb392-8"><a href="exploring-associations.html#cb392-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Body mass (g)&quot;</span>) <span class="sc">+</span></span>
<span id="cb392-9"><a href="exploring-associations.html#cb392-9" aria-hidden="true" tabindex="-1"></a>  <span class="co"># facet by species to get one panel per species</span></span>
<span id="cb392-10"><a href="exploring-associations.html#cb392-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="fu">vars</span>(species))</span></code></pre></div>
<p><img src="intro-bio-data-book_files/figure-html/unnamed-chunk-255-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>The two histogram plots tell much the same story as the box and whiskers plot. The body mass distributions of Chinstrap and Adelie penguins are very similar, Gentoo penguins are generally a bit larger, but all three distributions overlap to some extent.</p>
</div>
</div>
<div id="multivariate" class="section level2" number="16.4">
<h2><span class="header-section-number">16.4</span> Multivariate associations</h2>
<p>We have now examined several ways for summarising associations between two variables. How do we explore associations between more than two variables in a single graph? That is, how do we explore <strong>multivariate associations</strong>? It is difficult to give a concrete answer because it depends on the scientific question we’re addressing, the kinds of variables we’re working with, and to a large extent, our creativity and aptitude with a graphing framework like <strong>ggplot2</strong>.</p>
<p>We have already seen enough of <strong>ggplot2</strong> works to build some fairly sophisticated visualisations.The key point is that we don’t really need to learn anything new to visualise multivariate associations. There are two ways to add additional information to a visualisation, both of which we have already reviewed:</p>
<ol style="list-style-type: decimal">
<li>Define aesthetic mappings to allow a layer’s properties to depend on the values of one or more variables.</li>
<li>Use faceting to construct a multi-panel plot according to the values of categorical variables.</li>
</ol>
<p>Constructing a multivariate visualisation is a matter of combining these approaches to squeeze information from several variables into a single graph.</p>
<p>We saw these approaches used together in the <a href="chapter-ggplot2-intro.html#chapter-ggplot2-intro">Introduction to ggplot2</a> chapter. Let’s look at one more example to cement the idea. We want to understand how the flipper length relates to body mass and how this numeric-numeric relationship varies by species, sex and island. That’s five variables in one plot!</p>
<p>The obvious idea is to produce a multi-panel scatter plot, where each panel is associated with combinations of the categorical variables. We have already seen how to do this kind of thing with <code>facet_wrap</code>. This time, we’ll use the <code>facet_grid</code> function to organise separate panels for each sex-species combination into a nice 2d grid:</p>
<div class="sourceCode" id="cb393"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb393-1"><a href="exploring-associations.html#cb393-1" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb393-2"><a href="exploring-associations.html#cb393-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">na.omit</span>(penguins), </span>
<span id="cb393-3"><a href="exploring-associations.html#cb393-3" aria-hidden="true" tabindex="-1"></a>       <span class="co"># aesthetic mappings</span></span>
<span id="cb393-4"><a href="exploring-associations.html#cb393-4" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(</span>
<span id="cb393-5"><a href="exploring-associations.html#cb393-5" aria-hidden="true" tabindex="-1"></a>         <span class="co"># flipper length (y) vs body mass (x)</span></span>
<span id="cb393-6"><a href="exploring-associations.html#cb393-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">x =</span> body_mass_g, <span class="at">y =</span> flipper_length_mm, </span>
<span id="cb393-7"><a href="exploring-associations.html#cb393-7" aria-hidden="true" tabindex="-1"></a>         <span class="co"># colour AND shape of points vary by island</span></span>
<span id="cb393-8"><a href="exploring-associations.html#cb393-8" aria-hidden="true" tabindex="-1"></a>         <span class="at">colour =</span> island, <span class="at">shape =</span> island)) <span class="sc">+</span></span>
<span id="cb393-9"><a href="exploring-associations.html#cb393-9" aria-hidden="true" tabindex="-1"></a>  <span class="co"># geom_point to add points layer</span></span>
<span id="cb393-10"><a href="exploring-associations.html#cb393-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb393-11"><a href="exploring-associations.html#cb393-11" aria-hidden="true" tabindex="-1"></a>  <span class="co"># specify labels for ALL mappings (both Island labels required)</span></span>
<span id="cb393-12"><a href="exploring-associations.html#cb393-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Body size (g)&quot;</span>, </span>
<span id="cb393-13"><a href="exploring-associations.html#cb393-13" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Flipper length (mm)&quot;</span>,</span>
<span id="cb393-14"><a href="exploring-associations.html#cb393-14" aria-hidden="true" tabindex="-1"></a>       <span class="at">colour =</span> <span class="st">&quot;Island&quot;</span>, <span class="at">shape =</span> <span class="st">&quot;Island&quot;</span>) <span class="sc">+</span></span>
<span id="cb393-15"><a href="exploring-associations.html#cb393-15" aria-hidden="true" tabindex="-1"></a>  <span class="co"># facet on sex by species grid</span></span>
<span id="cb393-16"><a href="exploring-associations.html#cb393-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(<span class="at">rows =</span> <span class="fu">vars</span>(sex), <span class="at">cols =</span> <span class="fu">vars</span>(species))</span></code></pre></div>
<p><img src="intro-bio-data-book_files/figure-html/unnamed-chunk-256-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>Simple. We set some aesthetics and used faceting to squeeze the five variables into one plot. The <code>facet_grid</code> function represents the values two or more categorical variables by row and column position, which means we have to set <code>rows</code> and <code>cols</code> arguments. The <code>vars(…)</code> bit is not optional by the way. We also took the opportunity to introduce a couple of new tricks:</p>
<ul>
<li>We used the base R <code>na.omit</code> function on penguins to strip out any rows with a missing value. This avoids introducing an ‘NA’ category in the faceting. This trick can be a bit dangerous because <code>na.omit</code> removes every case where a value is missing.</li>
<li>We introduced some redundancy by mapping one variable (<code>island</code>) to two different aesthetics (<code>colour</code> and <code>shape</code>). This achieves two things. It makes it easier to differentiate the points, and it ensures a plot can be understood if printed in black and white.</li>
</ul>
<p>There is lots of information in this plot—for example, the association between flipper length and body mass is weakly positive, sexual dimorphism in body size seems to be greatest in Gentoo penguins, and the Adelie species is the only one present on all three islands.</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="exploring-one-variable.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="doing-more-with-ggplot2.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["intro-bio-data-book.pdf", "intro-bio-data-book.epub"],
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
