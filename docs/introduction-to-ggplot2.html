<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 13 Introduction to ggplot2 | Exploratory Data Analysis with R</title>
  <meta name="description" content="This is the Exploratory Data Analysis in R book provided by the School of Biosciences at the University of Sheffield." />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 13 Introduction to ggplot2 | Exploratory Data Analysis with R" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This is the Exploratory Data Analysis in R book provided by the School of Biosciences at the University of Sheffield." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 13 Introduction to ggplot2 | Exploratory Data Analysis with R" />
  
  <meta name="twitter:description" content="This is the Exploratory Data Analysis in R book provided by the School of Biosciences at the University of Sheffield." />
  

<meta name="author" content="Dylan Childs" />


<meta name="date" content="2021-04-03" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="exploratory-data-analysis.html"/>
<link rel="next" href="customising-plots.html"/>
<script src="libs/header-attrs-2.5/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<link href="libs/anchor-sections-1.0/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0/anchor-sections.js"></script>
<link href="libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="libs/pagedtable-1.1/js/pagedtable.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Exploratory Data Analysis with R</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>What you will learn</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#aims"><i class="fa fa-check"></i>Aims</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#topics"><i class="fa fa-check"></i>Topics</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#technologies"><i class="fa fa-check"></i>Technologies</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#what-is-r"><i class="fa fa-check"></i>What is R?</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#what-is-rstudio"><i class="fa fa-check"></i>What is RStudio?</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="how-to-use-this-book.html"><a href="how-to-use-this-book.html"><i class="fa fa-check"></i>How to use this book</a>
<ul>
<li class="chapter" data-level="" data-path="how-to-use-this-book.html"><a href="how-to-use-this-book.html#text-instructions-and-explanations"><i class="fa fa-check"></i>Text, instructions, and explanations</a></li>
<li class="chapter" data-level="" data-path="how-to-use-this-book.html"><a href="how-to-use-this-book.html#r-code-and-output"><i class="fa fa-check"></i>R code and output</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="get-up-and-running.html"><a href="get-up-and-running.html"><i class="fa fa-check"></i>Get up and running</a>
<ul>
<li class="chapter" data-level="" data-path="get-up-and-running.html"><a href="get-up-and-running.html#different-ways-to-run-rstudio"><i class="fa fa-check"></i>Different ways to run RStudio</a></li>
<li class="chapter" data-level="" data-path="get-up-and-running.html"><a href="get-up-and-running.html#installing-r-and-rstudio-locally"><i class="fa fa-check"></i>Installing R and RStudio locally</a>
<ul>
<li class="chapter" data-level="" data-path="get-up-and-running.html"><a href="get-up-and-running.html#installing-rstudio"><i class="fa fa-check"></i>Installing RStudio</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="get-up-and-running.html"><a href="get-up-and-running.html#a-quick-look-at-rstudio"><i class="fa fa-check"></i>A quick look at RStudio</a></li>
<li class="chapter" data-level="" data-path="get-up-and-running.html"><a href="get-up-and-running.html#working-at-console"><i class="fa fa-check"></i>Working at the Console in RStudio</a></li>
</ul></li>
<li class="part"><span><b>I Introduction to R</b></span></li>
<li class="chapter" data-level="1" data-path="quick-intro-to-r.html"><a href="quick-intro-to-r.html"><i class="fa fa-check"></i><b>1</b> A quick introduction to R</a>
<ul>
<li class="chapter" data-level="1.1" data-path="quick-intro-to-r.html"><a href="quick-intro-to-r.html#r-calculator"><i class="fa fa-check"></i><b>1.1</b> Using R as a big calculator</a>
<ul>
<li class="chapter" data-level="1.1.1" data-path="quick-intro-to-r.html"><a href="quick-intro-to-r.html#basic-arithmetic"><i class="fa fa-check"></i><b>1.1.1</b> Basic arithmetic</a></li>
<li class="chapter" data-level="1.1.2" data-path="quick-intro-to-r.html"><a href="quick-intro-to-r.html#combining-arithmetic-operations"><i class="fa fa-check"></i><b>1.1.2</b> Combining arithmetic operations</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="quick-intro-to-r.html"><a href="quick-intro-to-r.html#problematic-calculations"><i class="fa fa-check"></i><b>1.2</b> Problematic calculations</a></li>
<li class="chapter" data-level="1.3" data-path="quick-intro-to-r.html"><a href="quick-intro-to-r.html#assignment"><i class="fa fa-check"></i><b>1.3</b> Storing and reusing results</a></li>
<li class="chapter" data-level="1.4" data-path="quick-intro-to-r.html"><a href="quick-intro-to-r.html#how-does-assignment-work"><i class="fa fa-check"></i><b>1.4</b> How does assignment work?</a></li>
<li class="chapter" data-level="1.5" data-path="quick-intro-to-r.html"><a href="quick-intro-to-r.html#global-environment"><i class="fa fa-check"></i><b>1.5</b> Global environment</a></li>
<li class="chapter" data-level="1.6" data-path="quick-intro-to-r.html"><a href="quick-intro-to-r.html#naming-rules-and-conventions"><i class="fa fa-check"></i><b>1.6</b> Naming rules and conventions</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="using-functions.html"><a href="using-functions.html"><i class="fa fa-check"></i><b>2</b> Using functions</a>
<ul>
<li class="chapter" data-level="2.1" data-path="using-functions.html"><a href="using-functions.html#intro-functions"><i class="fa fa-check"></i><b>2.1</b> Introduction</a></li>
<li class="chapter" data-level="2.2" data-path="using-functions.html"><a href="using-functions.html#functions-and-arguments"><i class="fa fa-check"></i><b>2.2</b> Functions and arguments</a></li>
<li class="chapter" data-level="2.3" data-path="using-functions.html"><a href="using-functions.html#evaluating-arguments-and-returning-results"><i class="fa fa-check"></i><b>2.3</b> Evaluating arguments and returning results</a></li>
<li class="chapter" data-level="2.4" data-path="using-functions.html"><a href="using-functions.html#function-arguments"><i class="fa fa-check"></i><b>2.4</b> Specifying function arguments</a></li>
<li class="chapter" data-level="2.5" data-path="using-functions.html"><a href="using-functions.html#combining-functions"><i class="fa fa-check"></i><b>2.5</b> Combining functions</a></li>
<li class="chapter" data-level="2.6" data-path="using-functions.html"><a href="using-functions.html#functions-do-not-have-side-effects"><i class="fa fa-check"></i><b>2.6</b> Functions do not have ‘side effects’</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="vectors.html"><a href="vectors.html"><i class="fa fa-check"></i><b>3</b> Vectors</a>
<ul>
<li class="chapter" data-level="3.1" data-path="vectors.html"><a href="vectors.html#introduction"><i class="fa fa-check"></i><b>3.1</b> Introduction</a></li>
<li class="chapter" data-level="3.2" data-path="vectors.html"><a href="vectors.html#atomic-vectors"><i class="fa fa-check"></i><b>3.2</b> Atomic vectors</a></li>
<li class="chapter" data-level="3.3" data-path="vectors.html"><a href="vectors.html#intro-vectors"><i class="fa fa-check"></i><b>3.3</b> Numeric vectors</a></li>
<li class="chapter" data-level="3.4" data-path="vectors.html"><a href="vectors.html#constructing-numeric-vectors"><i class="fa fa-check"></i><b>3.4</b> Constructing numeric vectors</a></li>
<li class="chapter" data-level="3.5" data-path="vectors.html"><a href="vectors.html#named-vectors"><i class="fa fa-check"></i><b>3.5</b> Named vectors</a></li>
<li class="chapter" data-level="3.6" data-path="vectors.html"><a href="vectors.html#vectorised-operations"><i class="fa fa-check"></i><b>3.6</b> Vectorised operations</a></li>
<li class="chapter" data-level="3.7" data-path="vectors.html"><a href="vectors.html#other-vectors"><i class="fa fa-check"></i><b>3.7</b> Other kinds of atomic vectors</a>
<ul>
<li class="chapter" data-level="3.7.1" data-path="vectors.html"><a href="vectors.html#character-vectors"><i class="fa fa-check"></i><b>3.7.1</b> Character vectors</a></li>
<li class="chapter" data-level="3.7.2" data-path="vectors.html"><a href="vectors.html#logical-vectors"><i class="fa fa-check"></i><b>3.7.2</b> Logical vectors</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="chapter-data-frames.html"><a href="chapter-data-frames.html"><i class="fa fa-check"></i><b>4</b> Data frames</a>
<ul>
<li class="chapter" data-level="4.1" data-path="chapter-data-frames.html"><a href="chapter-data-frames.html#introduction-1"><i class="fa fa-check"></i><b>4.1</b> Introduction</a></li>
<li class="chapter" data-level="4.2" data-path="chapter-data-frames.html"><a href="chapter-data-frames.html#data-frames-intro"><i class="fa fa-check"></i><b>4.2</b> Data frames</a></li>
<li class="chapter" data-level="4.3" data-path="chapter-data-frames.html"><a href="chapter-data-frames.html#exploring-data-frames"><i class="fa fa-check"></i><b>4.3</b> Exploring data frames</a></li>
<li class="chapter" data-level="4.4" data-path="chapter-data-frames.html"><a href="chapter-data-frames.html#extracting-and-adding-a-single-variable"><i class="fa fa-check"></i><b>4.4</b> Extracting and adding a single variable</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="packages.html"><a href="packages.html"><i class="fa fa-check"></i><b>5</b> Packages</a>
<ul>
<li class="chapter" data-level="5.1" data-path="packages.html"><a href="packages.html#package-system"><i class="fa fa-check"></i><b>5.1</b> The R package system</a></li>
<li class="chapter" data-level="5.2" data-path="packages.html"><a href="packages.html#task-views"><i class="fa fa-check"></i><b>5.2</b> Task views</a></li>
<li class="chapter" data-level="5.3" data-path="packages.html"><a href="packages.html#use-packages"><i class="fa fa-check"></i><b>5.3</b> Using packages</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="packages.html"><a href="packages.html#viewing-installed-packages"><i class="fa fa-check"></i><b>5.3.1</b> Viewing installed packages</a></li>
<li class="chapter" data-level="5.3.2" data-path="packages.html"><a href="packages.html#installing-packages"><i class="fa fa-check"></i><b>5.3.2</b> Installing packages</a></li>
<li class="chapter" data-level="5.3.3" data-path="packages.html"><a href="packages.html#loading-and-attaching-packages"><i class="fa fa-check"></i><b>5.3.3</b> Loading and attaching packages</a></li>
<li class="chapter" data-level="5.3.4" data-path="packages.html"><a href="packages.html#dont-use-rstudio-for-loading-packages"><i class="fa fa-check"></i><b>5.3.4</b> Don’t use RStudio for loading packages!</a></li>
<li class="chapter" data-level="5.3.5" data-path="packages.html"><a href="packages.html#an-analogy"><i class="fa fa-check"></i><b>5.3.5</b> An analogy</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="packages.html"><a href="packages.html#package-data"><i class="fa fa-check"></i><b>5.4</b> Package data</a></li>
<li class="chapter" data-level="5.5" data-path="packages.html"><a href="packages.html#the-tidyverse-ecosystem-of-packages"><i class="fa fa-check"></i><b>5.5</b> The tidyverse ecosystem of packages</a></li>
</ul></li>
<li class="part"><span><b>II Data Wrangling</b></span></li>
<li class="chapter" data-level="6" data-path="getting-ready-to-use-dplyr.html"><a href="getting-ready-to-use-dplyr.html"><i class="fa fa-check"></i><b>6</b> Getting ready to use <strong>dplyr</strong></a>
<ul>
<li class="chapter" data-level="6.1" data-path="getting-ready-to-use-dplyr.html"><a href="getting-ready-to-use-dplyr.html#introduction-2"><i class="fa fa-check"></i><b>6.1</b> Introduction</a></li>
<li class="chapter" data-level="6.2" data-path="getting-ready-to-use-dplyr.html"><a href="getting-ready-to-use-dplyr.html#tidy-data"><i class="fa fa-check"></i><b>6.2</b> Tidy data</a></li>
<li class="chapter" data-level="6.3" data-path="getting-ready-to-use-dplyr.html"><a href="getting-ready-to-use-dplyr.html#penguins-data-overview"><i class="fa fa-check"></i><b>6.3</b> Penguins! 🐧+📊= 😃</a></li>
<li class="chapter" data-level="6.4" data-path="getting-ready-to-use-dplyr.html"><a href="getting-ready-to-use-dplyr.html#um-tibbles"><i class="fa fa-check"></i><b>6.4</b> Um… tibbles?</a></li>
<li class="chapter" data-level="6.5" data-path="getting-ready-to-use-dplyr.html"><a href="getting-ready-to-use-dplyr.html#missing-values"><i class="fa fa-check"></i><b>6.5</b> Missing values</a></li>
<li class="chapter" data-level="6.6" data-path="getting-ready-to-use-dplyr.html"><a href="getting-ready-to-use-dplyr.html#why-dplyr"><i class="fa fa-check"></i><b>6.6</b> Introducing <strong>dplyr</strong></a>
<ul>
<li class="chapter" data-level="6.6.1" data-path="getting-ready-to-use-dplyr.html"><a href="getting-ready-to-use-dplyr.html#more-dplyr"><i class="fa fa-check"></i><b>6.6.1</b> A first look at <strong>dplyr</strong></a></li>
<li class="chapter" data-level="6.6.2" data-path="getting-ready-to-use-dplyr.html"><a href="getting-ready-to-use-dplyr.html#dplyr-pseudocode"><i class="fa fa-check"></i><b>6.6.2</b> <strong>dplyr</strong> pseudocode</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="working-with-variables.html"><a href="working-with-variables.html"><i class="fa fa-check"></i><b>7</b> Working with variables</a>
<ul>
<li class="chapter" data-level="7.1" data-path="working-with-variables.html"><a href="working-with-variables.html#introduction-3"><i class="fa fa-check"></i><b>7.1</b> Introduction</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="working-with-variables.html"><a href="working-with-variables.html#getting-ready"><i class="fa fa-check"></i><b>7.1.1</b> Getting ready</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="working-with-variables.html"><a href="working-with-variables.html#subset-variables-with-select"><i class="fa fa-check"></i><b>7.2</b> Subset variables with <code>select</code></a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="working-with-variables.html"><a href="working-with-variables.html#alternative-ways-to-identify-variables-with-select"><i class="fa fa-check"></i><b>7.2.1</b> Alternative ways to identify variables with <code>select</code></a></li>
<li class="chapter" data-level="7.2.2" data-path="working-with-variables.html"><a href="working-with-variables.html#renaming-variables-with-select-and-rename"><i class="fa fa-check"></i><b>7.2.2</b> Renaming variables with <code>select</code> and <code>rename</code></a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="working-with-variables.html"><a href="working-with-variables.html#creating-variables-with-mutate"><i class="fa fa-check"></i><b>7.3</b> Creating variables with <code>mutate</code></a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="working-with-variables.html"><a href="working-with-variables.html#transforming-and-dropping-variables"><i class="fa fa-check"></i><b>7.3.1</b> Transforming and dropping variables</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="working-with-observations.html"><a href="working-with-observations.html"><i class="fa fa-check"></i><b>8</b> Working with observations</a>
<ul>
<li class="chapter" data-level="8.1" data-path="working-with-observations.html"><a href="working-with-observations.html#introduction-4"><i class="fa fa-check"></i><b>8.1</b> Introduction</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="working-with-observations.html"><a href="working-with-observations.html#getting-ready-1"><i class="fa fa-check"></i><b>8.1.1</b> Getting ready</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="working-with-observations.html"><a href="working-with-observations.html#relational-and-logical-operators"><i class="fa fa-check"></i><b>8.2</b> Relational and logical operators</a></li>
<li class="chapter" data-level="8.3" data-path="working-with-observations.html"><a href="working-with-observations.html#subset-observations-with-filter"><i class="fa fa-check"></i><b>8.3</b> Subset observations with <code>filter</code></a></li>
<li class="chapter" data-level="8.4" data-path="working-with-observations.html"><a href="working-with-observations.html#reordering-observations-with-arrange"><i class="fa fa-check"></i><b>8.4</b> Reordering observations with <code>arrange</code></a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="summarising-and-grouping.html"><a href="summarising-and-grouping.html"><i class="fa fa-check"></i><b>9</b> Summarising and grouping</a>
<ul>
<li class="chapter" data-level="9.1" data-path="summarising-and-grouping.html"><a href="summarising-and-grouping.html#summarising-variables-with-summarise"><i class="fa fa-check"></i><b>9.1</b> Summarising variables with <code>summarise</code></a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="summarising-and-grouping.html"><a href="summarising-and-grouping.html#more-complicated-calculations-with-summarise"><i class="fa fa-check"></i><b>9.1.1</b> More complicated calculations with <code>summarise</code></a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="summarising-and-grouping.html"><a href="summarising-and-grouping.html#grouped-operations-using-group_by"><i class="fa fa-check"></i><b>9.2</b> Grouped operations using <code>group_by</code></a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="summarising-and-grouping.html"><a href="summarising-and-grouping.html#more-than-one-grouping-variable"><i class="fa fa-check"></i><b>9.2.1</b> More than one grouping variable</a></li>
<li class="chapter" data-level="9.2.2" data-path="summarising-and-grouping.html"><a href="summarising-and-grouping.html#using-group_by-with-other-verbs"><i class="fa fa-check"></i><b>9.2.2</b> Using <code>group_by</code> with other verbs</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="summarising-and-grouping.html"><a href="summarising-and-grouping.html#removing-grouping-information"><i class="fa fa-check"></i><b>9.3</b> Removing grouping information</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="building-pipelines.html"><a href="building-pipelines.html"><i class="fa fa-check"></i><b>10</b> Building pipelines</a>
<ul>
<li class="chapter" data-level="10.1" data-path="building-pipelines.html"><a href="building-pipelines.html#why-do-we-need-pipes"><i class="fa fa-check"></i><b>10.1</b> Why do we need ‘pipes?’</a></li>
<li class="chapter" data-level="10.2" data-path="building-pipelines.html"><a href="building-pipelines.html#using-pipes"><i class="fa fa-check"></i><b>10.2</b> Using pipes (<code>%&gt;%</code>)</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="helper-functions.html"><a href="helper-functions.html"><i class="fa fa-check"></i><b>11</b> Helper functions</a>
<ul>
<li class="chapter" data-level="11.1" data-path="helper-functions.html"><a href="helper-functions.html#introduction-5"><i class="fa fa-check"></i><b>11.1</b> Introduction</a></li>
<li class="chapter" data-level="11.2" data-path="helper-functions.html"><a href="helper-functions.html#working-with-select"><i class="fa fa-check"></i><b>11.2</b> Working with <code>select</code></a></li>
<li class="chapter" data-level="11.3" data-path="helper-functions.html"><a href="helper-functions.html#working-with-mutate-and-transmute"><i class="fa fa-check"></i><b>11.3</b> Working with <code>mutate</code> and <code>transmute</code></a></li>
<li class="chapter" data-level="11.4" data-path="helper-functions.html"><a href="helper-functions.html#working-with-filter"><i class="fa fa-check"></i><b>11.4</b> Working with <code>filter</code></a></li>
<li class="chapter" data-level="11.5" data-path="helper-functions.html"><a href="helper-functions.html#working-with-summarise"><i class="fa fa-check"></i><b>11.5</b> Working with <code>summarise</code></a></li>
</ul></li>
<li class="part"><span><b>III Exporing Data</b></span></li>
<li class="chapter" data-level="12" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html"><i class="fa fa-check"></i><b>12</b> Exploratory data analysis</a>
<ul>
<li class="chapter" data-level="12.1" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#introduction-6"><i class="fa fa-check"></i><b>12.1</b> Introduction</a></li>
<li class="chapter" data-level="12.2" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#variables"><i class="fa fa-check"></i><b>12.2</b> Statistical variables and data</a>
<ul>
<li class="chapter" data-level="12.2.1" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#numeric-vs-categorical-variables"><i class="fa fa-check"></i><b>12.2.1</b> Numeric vs categorical variables</a></li>
<li class="chapter" data-level="12.2.2" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#ratio-vs-interval-scales"><i class="fa fa-check"></i><b>12.2.2</b> Ratio vs interval scales</a></li>
</ul></li>
<li class="chapter" data-level="12.3" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#populations-samples"><i class="fa fa-check"></i><b>12.3</b> Populations and samples</a>
<ul>
<li class="chapter" data-level="12.3.1" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#sample-distributions"><i class="fa fa-check"></i><b>12.3.1</b> Sample distributions</a></li>
<li class="chapter" data-level="12.3.2" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#relationships"><i class="fa fa-check"></i><b>12.3.2</b> Relationships</a></li>
</ul></li>
<li class="chapter" data-level="12.4" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#types-of-eda"><i class="fa fa-check"></i><b>12.4</b> Types of EDA</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="introduction-to-ggplot2.html"><a href="introduction-to-ggplot2.html"><i class="fa fa-check"></i><b>13</b> Introduction to <strong>ggplot2</strong></a>
<ul>
<li class="chapter" data-level="13.1" data-path="introduction-to-ggplot2.html"><a href="introduction-to-ggplot2.html#anatomy"><i class="fa fa-check"></i><b>13.1</b> The anatomy of ggplot2</a>
<ul>
<li class="chapter" data-level="13.1.1" data-path="introduction-to-ggplot2.html"><a href="introduction-to-ggplot2.html#layers"><i class="fa fa-check"></i><b>13.1.1</b> Layers</a></li>
<li class="chapter" data-level="13.1.2" data-path="introduction-to-ggplot2.html"><a href="introduction-to-ggplot2.html#scales"><i class="fa fa-check"></i><b>13.1.2</b> Scales</a></li>
<li class="chapter" data-level="13.1.3" data-path="introduction-to-ggplot2.html"><a href="introduction-to-ggplot2.html#coordinate-system"><i class="fa fa-check"></i><b>13.1.3</b> Coordinate system</a></li>
<li class="chapter" data-level="13.1.4" data-path="introduction-to-ggplot2.html"><a href="introduction-to-ggplot2.html#faceting"><i class="fa fa-check"></i><b>13.1.4</b> Faceting</a></li>
</ul></li>
<li class="chapter" data-level="13.2" data-path="introduction-to-ggplot2.html"><a href="introduction-to-ggplot2.html#quick"><i class="fa fa-check"></i><b>13.2</b> A quick introduction to ggplot2</a>
<ul>
<li class="chapter" data-level="13.2.1" data-path="introduction-to-ggplot2.html"><a href="introduction-to-ggplot2.html#making-a-start"><i class="fa fa-check"></i><b>13.2.1</b> Making a start</a></li>
<li class="chapter" data-level="13.2.2" data-path="introduction-to-ggplot2.html"><a href="introduction-to-ggplot2.html#a-standard-way-of-using-ggplot2"><i class="fa fa-check"></i><b>13.2.2</b> A standard way of using <strong>ggplot2</strong></a></li>
</ul></li>
<li class="chapter" data-level="13.3" data-path="introduction-to-ggplot2.html"><a href="introduction-to-ggplot2.html#increasing-the-information-density"><i class="fa fa-check"></i><b>13.3</b> Increasing the information density</a>
<ul>
<li class="chapter" data-level="13.3.1" data-path="introduction-to-ggplot2.html"><a href="introduction-to-ggplot2.html#using-additional-aesthetics"><i class="fa fa-check"></i><b>13.3.1</b> Using additional aesthetics</a></li>
<li class="chapter" data-level="13.3.2" data-path="introduction-to-ggplot2.html"><a href="introduction-to-ggplot2.html#using-facets"><i class="fa fa-check"></i><b>13.3.2</b> Using facets</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="14" data-path="customising-plots.html"><a href="customising-plots.html"><i class="fa fa-check"></i><b>14</b> Customising plots</a>
<ul>
<li class="chapter" data-level="14.1" data-path="customising-plots.html"><a href="customising-plots.html#working-with-layer-specific-geom-properties"><i class="fa fa-check"></i><b>14.1</b> Working with layer specific geom properties</a>
<ul>
<li class="chapter" data-level="14.1.1" data-path="customising-plots.html"><a href="customising-plots.html#the-relationship-between-aesthetics-and-geom-properties."><i class="fa fa-check"></i><b>14.1.1</b> The relationship between aesthetics and geom properties.</a></li>
</ul></li>
<li class="chapter" data-level="14.2" data-path="customising-plots.html"><a href="customising-plots.html#working-with-layer-specific-position-adjustments"><i class="fa fa-check"></i><b>14.2</b> Working with layer specific position adjustments</a></li>
<li class="chapter" data-level="14.3" data-path="customising-plots.html"><a href="customising-plots.html#working-with-plot-specific-scales"><i class="fa fa-check"></i><b>14.3</b> Working with plot specific scales</a></li>
<li class="chapter" data-level="14.4" data-path="customising-plots.html"><a href="customising-plots.html#adding-titles-and-labels"><i class="fa fa-check"></i><b>14.4</b> Adding titles and labels</a></li>
<li class="chapter" data-level="14.5" data-path="customising-plots.html"><a href="customising-plots.html#themes"><i class="fa fa-check"></i><b>14.5</b> Themes</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="exploring-one-variable.html"><a href="exploring-one-variable.html"><i class="fa fa-check"></i><b>15</b> Exploring one variable</a>
<ul>
<li class="chapter" data-level="15.1" data-path="exploring-one-variable.html"><a href="exploring-one-variable.html#explore-numeric"><i class="fa fa-check"></i><b>15.1</b> Understanding numerical variables</a></li>
<li class="chapter" data-level="15.2" data-path="exploring-one-variable.html"><a href="exploring-one-variable.html#graphical-summaries"><i class="fa fa-check"></i><b>15.2</b> Graphical summaries</a></li>
<li class="chapter" data-level="15.3" data-path="exploring-one-variable.html"><a href="exploring-one-variable.html#descriptive-statistics"><i class="fa fa-check"></i><b>15.3</b> Descriptive statistics</a>
<ul>
<li class="chapter" data-level="15.3.1" data-path="exploring-one-variable.html"><a href="exploring-one-variable.html#measuring-central-tendency"><i class="fa fa-check"></i><b>15.3.1</b> Measuring central tendency</a></li>
<li class="chapter" data-level="15.3.2" data-path="exploring-one-variable.html"><a href="exploring-one-variable.html#measuring-dispersion"><i class="fa fa-check"></i><b>15.3.2</b> Measuring dispersion</a></li>
<li class="chapter" data-level="15.3.3" data-path="exploring-one-variable.html"><a href="exploring-one-variable.html#skewness"><i class="fa fa-check"></i><b>15.3.3</b> Skewness</a></li>
</ul></li>
<li class="chapter" data-level="15.4" data-path="exploring-one-variable.html"><a href="exploring-one-variable.html#explore-categorical"><i class="fa fa-check"></i><b>15.4</b> Understanding categorical variables</a>
<ul>
<li class="chapter" data-level="15.4.1" data-path="exploring-one-variable.html"><a href="exploring-one-variable.html#numerical-summaries"><i class="fa fa-check"></i><b>15.4.1</b> Numerical summaries</a></li>
</ul></li>
<li class="chapter" data-level="15.5" data-path="exploring-one-variable.html"><a href="exploring-one-variable.html#graphical-summaries-of-categorical-variables"><i class="fa fa-check"></i><b>15.5</b> Graphical summaries of categorical variables</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="exploring-relationships-between-variables.html"><a href="exploring-relationships-between-variables.html"><i class="fa fa-check"></i><b>16</b> Exploring relationships between variables</a>
<ul>
<li class="chapter" data-level="16.1" data-path="exploring-relationships-between-variables.html"><a href="exploring-relationships-between-variables.html#numeric"><i class="fa fa-check"></i><b>16.1</b> Associations between numeric variables</a>
<ul>
<li class="chapter" data-level="16.1.1" data-path="exploring-relationships-between-variables.html"><a href="exploring-relationships-between-variables.html#descriptive-statistics-1"><i class="fa fa-check"></i><b>16.1.1</b> Descriptive statistics</a></li>
<li class="chapter" data-level="16.1.2" data-path="exploring-relationships-between-variables.html"><a href="exploring-relationships-between-variables.html#graphical-summaries-1"><i class="fa fa-check"></i><b>16.1.2</b> Graphical summaries</a></li>
</ul></li>
<li class="chapter" data-level="16.2" data-path="exploring-relationships-between-variables.html"><a href="exploring-relationships-between-variables.html#categorical"><i class="fa fa-check"></i><b>16.2</b> Associations between categorical variables</a>
<ul>
<li class="chapter" data-level="16.2.1" data-path="exploring-relationships-between-variables.html"><a href="exploring-relationships-between-variables.html#numerical-summaries-1"><i class="fa fa-check"></i><b>16.2.1</b> Numerical summaries</a></li>
<li class="chapter" data-level="16.2.2" data-path="exploring-relationships-between-variables.html"><a href="exploring-relationships-between-variables.html#graphical-summaries-2"><i class="fa fa-check"></i><b>16.2.2</b> Graphical summaries</a></li>
</ul></li>
<li class="chapter" data-level="16.3" data-path="exploring-relationships-between-variables.html"><a href="exploring-relationships-between-variables.html#cat-num-association"><i class="fa fa-check"></i><b>16.3</b> Categorical-numerical associations</a>
<ul>
<li class="chapter" data-level="16.3.1" data-path="exploring-relationships-between-variables.html"><a href="exploring-relationships-between-variables.html#descriptive-statistics-2"><i class="fa fa-check"></i><b>16.3.1</b> Descriptive statistics</a></li>
<li class="chapter" data-level="16.3.2" data-path="exploring-relationships-between-variables.html"><a href="exploring-relationships-between-variables.html#graphical-summaries-3"><i class="fa fa-check"></i><b>16.3.2</b> Graphical summaries</a></li>
<li class="chapter" data-level="16.3.3" data-path="exploring-relationships-between-variables.html"><a href="exploring-relationships-between-variables.html#alternatives-to-box-and-whiskers-plots"><i class="fa fa-check"></i><b>16.3.3</b> Alternatives to box and whiskers plots</a></li>
</ul></li>
<li class="chapter" data-level="16.4" data-path="exploring-relationships-between-variables.html"><a href="exploring-relationships-between-variables.html#multivariate"><i class="fa fa-check"></i><b>16.4</b> Multivariate relationships</a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="doing-more-with-ggplot2.html"><a href="doing-more-with-ggplot2.html"><i class="fa fa-check"></i><b>17</b> Doing more with <strong>ggplot2</strong></a>
<ul>
<li class="chapter" data-level="17.1" data-path="doing-more-with-ggplot2.html"><a href="doing-more-with-ggplot2.html#summaries"><i class="fa fa-check"></i><b>17.1</b> Comparing descriptive statistics</a></li>
<li class="chapter" data-level="17.2" data-path="doing-more-with-ggplot2.html"><a href="doing-more-with-ggplot2.html#adding-error-bars"><i class="fa fa-check"></i><b>17.2</b> Adding error bars</a></li>
<li class="chapter" data-level="17.3" data-path="doing-more-with-ggplot2.html"><a href="doing-more-with-ggplot2.html#adding-text-to-plots"><i class="fa fa-check"></i><b>17.3</b> Adding text to plots</a></li>
<li class="chapter" data-level="17.4" data-path="doing-more-with-ggplot2.html"><a href="doing-more-with-ggplot2.html#customising-text"><i class="fa fa-check"></i><b>17.4</b> Customising text</a></li>
<li class="chapter" data-level="17.5" data-path="doing-more-with-ggplot2.html"><a href="doing-more-with-ggplot2.html#saving-plots"><i class="fa fa-check"></i><b>17.5</b> Saving plots</a></li>
<li class="chapter" data-level="17.6" data-path="doing-more-with-ggplot2.html"><a href="doing-more-with-ggplot2.html#panel-plots"><i class="fa fa-check"></i><b>17.6</b> Panel plots</a></li>
</ul></li>
<li class="appendix"><span><b>Supplementary Material</b></span></li>
<li class="chapter" data-level="A" data-path="getting-help.html"><a href="getting-help.html"><i class="fa fa-check"></i><b>A</b> Getting help</a>
<ul>
<li class="chapter" data-level="A.1" data-path="getting-help.html"><a href="getting-help.html#console-help"><i class="fa fa-check"></i><b>A.1</b> Introduction</a></li>
<li class="chapter" data-level="A.2" data-path="getting-help.html"><a href="getting-help.html#browsing-the-help-system"><i class="fa fa-check"></i><b>A.2</b> Browsing the help system</a></li>
<li class="chapter" data-level="A.3" data-path="getting-help.html"><a href="getting-help.html#searching-for-help-files"><i class="fa fa-check"></i><b>A.3</b> Searching for help files</a></li>
<li class="chapter" data-level="A.4" data-path="getting-help.html"><a href="getting-help.html#nav-help"><i class="fa fa-check"></i><b>A.4</b> Navigating help files</a></li>
<li class="chapter" data-level="A.5" data-path="getting-help.html"><a href="getting-help.html#vignettes"><i class="fa fa-check"></i><b>A.5</b> Vignettes and demos</a></li>
</ul></li>
<li class="chapter" data-level="B" data-path="project-scripts-data.html"><a href="project-scripts-data.html"><i class="fa fa-check"></i><b>B</b> Managing projects, scripts and data files</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Exploratory Data Analysis with R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="introduction-to-ggplot2" class="section level1" number="13">
<h1><span class="header-section-number">Chapter 13</span> Introduction to <strong>ggplot2</strong></h1>
<p>One of the main reasons data analysts turn to R is for its strong data visualisation capabilities. The R ecosystem includes many different packages that support data visualisation. The three most widely used are: 1) the base graphics system, which uses the <strong>graphics</strong> package; 2) the <strong>lattice</strong> package; and 3) the <strong>ggplot2</strong> package. Each system has its own strengths and weaknesses:</p>
<ul>
<li><p>Base graphics is part of base R, which means it’s always available. It’s very flexible and allows us to construct more or less any plot we like. This flexibility comes at a cost, though. While it is certainly easy to get up and running with base R graphics—there are functions like <code>plot</code> and <code>hist</code> for making commonly-used figures—building complex figures quickly becomes time-consuming. We have to write a lot of R code to prepare even moderately complex plots, there are many graphical parameters to learn, and many of the standard plotting functions are inconsistent in how they work.</p></li>
<li><p>Deepayan Sarkar developed the <strong>lattice</strong> package to implement the ideas of Bill Cleveland in his 1993 book, Visualizing Data. The package implements something called Trellis graphics, a very useful approach for graphical exploratory data analysis. Trellis graphics are designed to help us visualise complicated, multiple variable relationships. The <strong>lattice</strong> package has many “high level” functions (e.g. <code>xyplot</code>) to make this process easy, but still retains much of the fine-grained control that characterises the standard graphics system. The <strong>lattice</strong> package is very powerful, but it is hard to master.</p></li>
<li><p>Hadley Wickham developed the <strong>ggplot2</strong> package to implement the ideas in a book called The Grammar of Graphics by Wilkinson (2005). It produces Trellis-like graphics but is quite different from <strong>lattice</strong> in the way it goes about this. It uses its own mini-language to define graphical objects, adopting the language of Wilkinson’s book to define these. It takes a little while to learn the basics, but once these have been mastered it’s very easy to produce sophisticated plots with very little R code. The downside of working with <strong>ggplot2</strong> is that it isn’t as flexible as base graphics.</p></li>
</ul>
<p>We are not going to survey all these plotting systems. It’s entirely possible to meet most data visualisation needs by becoming proficient with just one of them. This book focuses on <strong>ggplot2</strong>. In many ways, the <strong>ggplot2</strong> package hits the ‘sweet spot’ between standard graphics and <strong>lattice</strong>. It enables us to produce complex visualisations without the need to write many lines of R code, but is still flexible enough to allow us to tweak the appearance of a figure so that it meets our specific needs.</p>
<div id="anatomy" class="section level2" number="13.1">
<h2><span class="header-section-number">13.1</span> The anatomy of ggplot2</h2>
<p>The easiest way to learn <strong>ggplot2</strong> is by using it. We will do that in a moment. However, before we dive in we need to review the essential features of the <strong>ggplot2</strong> ‘grammar’—the rules of how to specify a graph. This grammar is fairly abstract and it probably won’t make sense on first reading. This is fine. Ideas like ‘aesthetics’ and ‘geoms’ will start to make sense as we work through various examples in the next few chapters.</p>
<p>The design of <strong>ggplot2</strong> reflect Wilkinson’s grammar of graphics. A complete <strong>ggplot2</strong> object is defined by a combination of:</p>
<ol style="list-style-type: decimal">
<li>one or more <strong>layers</strong>,</li>
<li>a set of <strong>scales</strong> (one for each ‘aesthetic mapping’),</li>
<li>a <strong>coordinate system</strong> (one per plot),</li>
<li>a <strong>facet</strong> specification (if using a multi-panel plot).</li>
</ol>
<p>The underlying idea is that we construct a visualisation by defining one or more layers. Each layer is associated with some data and a set of rules for how to display the data. Let’s review these components before moving onto the business of actually using <strong>ggplot2</strong>.</p>
<div id="layers" class="section level3" number="13.1.1">
<h3><span class="header-section-number">13.1.1</span> Layers</h3>
<p>Each layer in a <strong>ggplot2</strong> plot may have five different components, though we don’t necessarily have to specify all of these because most have some kind of default setting or behaviour:</p>
<ul>
<li><p>The <strong>data</strong>. At a minimum, every plot needs some data. Unlike base R graphics, <strong>ggplot2</strong> always accepts data in one format, an R data frame (or tibble). Each layer can be associated with its own data set. We don’t have to explicitly add data to each layer. If we choose not to specify the data set for a layer, <strong>ggplot2</strong> will use the default data (if defined).</p></li>
<li><p>A set of <strong>aesthetic mappings</strong>. These describe how variables in the data are associated with the aesthetic properties of the layer. Aesthetic properties include things we perceive, such as position, colour, and size of the points. Each layer can be associated with its own unique aesthetic mappings. When we choose not to specify these for a layer <strong>ggplot2</strong> will use the defaults (if defined).</p></li>
<li><p>A <strong>geometric object</strong> (a.k.a. ‘geom’). The geom part of layer tells <strong>ggplot2</strong> how to actually represent the information—i.e. it refers to the objects we see on a plot, such as points, lines, bars or even text. Each geom only works with a particular subset of aesthetic mappings. We always have to define a geom when specifying a layer.</p></li>
<li><p>A <strong>statistical transformation</strong> (a.k.a. ‘stat’). A stat takes the raw data and transforms it in some way. A stat allows us to plot useful summaries of our raw data. We won’t explicitly make use of them in this book because we prefer to produce summary figures by first processing the data with <strong>dplyr</strong>. Nonetheless, the stat facility is often doing useful work in the background for some kinds of plots.</p></li>
<li><p>A <strong>position adjustment</strong>. These apply small tweaks to the position of layer elements. These are typically used when we need to define how the information for different categories are separated. For example, when making a bar plot we may need to specify whether bars should be stacked on top of one another (the default) or plotted side-by-side.</p></li>
</ul>
</div>
<div id="scales" class="section level3" number="13.1.2">
<h3><span class="header-section-number">13.1.2</span> Scales</h3>
<p>The scale part of a <strong>ggplot2</strong> object controls how the information in a variable is mapped to the aesthetic properties. A scale takes the data and converts it into something we can perceive, such as an x/y location, or the colour and size of points in a plot. The two most important things to understand about scales are:</p>
<ol style="list-style-type: decimal">
<li>A scale must be defined for every aesthetic in a plot. It doesn’t make sense to define an aesthetic mapping without a scale because there is no way for <strong>ggplot2</strong> to know how to go from the data to the aesthetics without one.</li>
<li>When we include two or more layers, they all have to use the same scale for any shared aesthetic mappings. This behaviour is necessary to ensure information is displayed consistently.</li>
</ol>
<p>If we choose not to explicitly define a scale for an aesthetic <strong>ggplot2</strong> will use a default. This will often be a ‘sensible’ choice, which means we can get quite a long way with <strong>ggplot2</strong> without ever really understanding scales. We will take a brief look at a few of the more common options, though.</p>
</div>
<div id="coordinate-system" class="section level3" number="13.1.3">
<h3><span class="header-section-number">13.1.3</span> Coordinate system</h3>
<p>A <strong>ggplot2</strong> coordinate system takes the position of objects (e.g. points and lines) and maps them onto the 2d plane that a plot lives on. Most people are already very familiar with the most common coordinate system (even if they didn’t realise it). That’s the Cartesian coordinate system. This is the one we’ve all been using since we first constructed a graph with paper and pencil at school. All the most common statistical plots use this coordinate system so we won’t consider any others in this book.</p>
</div>
<div id="faceting" class="section level3" number="13.1.4">
<h3><span class="header-section-number">13.1.4</span> Faceting</h3>
<p>The idea behind faceting is very simple. Faceting allows us to break a data set up into subsets according to the unique values of one or more variables and then produce a separate plot for each subset. The result is a multi-panel plot where each panel shares the same layers, scales, etc. The data is the only thing that varies from panel to panel. The result is a kind of ‘Trellis plot,’ similar to those produced by the <strong>lattice</strong> package. Faceting is a very powerful tool that allows us to slice up our data in different ways and really understand the relationship between different variables.</p>
</div>
</div>
<div id="quick" class="section level2" number="13.2">
<h2><span class="header-section-number">13.2</span> A quick introduction to ggplot2</h2>
<p>Now that we’ve briefly reviewed the <strong>ggplot2</strong> grammar, we can start learning how to use it. The package uses this grammar as the basis of a sort of mini-language within R. It uses functions to specify components like aesthetics and geoms, which are combined with data to define a <strong>ggplot2</strong> graphics object. Once we’ve constructed a suitable object, we can use it to display our graphic on the computer screen or save it using a common graphics format (e.g. PDF, PNG or JPEG).</p>
<p>Rather than orientating this introduction around each of the key functions we’re going to develop a simple example to help us see how <strong>ggplot2</strong> works. Many of the key ideas about how <strong>ggplot2</strong> works can be taken away from this one example, so it’s worth investing the time to understand it, i.e. use the example to understand how the different <strong>ggplot2</strong> functions are related to the grammar outlined above.</p>
<p>Our goal is to produce a simple scatter plot. The scatter plot is one of the most commonly used visualisation tools in the EDA toolbox. A scatter plot uses horizontal and vertical axes (the ‘x’ and ‘y’ axes) to visualise pairs of related observations as a series of points in two dimensions. It’s designed to show how one numeric variable is related to another. We’ll use the <code>penguins</code> data to construct the scatter plot. The questions we want to explore are:</p>
<ul>
<li>what is the relationship between bill depth and bill length, and</li>
<li>does this vary among species and locations (islands)?</li>
</ul>
<div id="making-a-start" class="section level3" number="13.2.1">
<h3><span class="header-section-number">13.2.1</span> Making a start</h3>
<p>We can start working <strong>ggplot2</strong> by setting up a minimal graphical object to build on. This is what the <code>ggplot</code> function does. We can build an empty object by using <code>ggplot</code> without any arguments:</p>
<div class="sourceCode" id="cb297"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb297-1"><a href="introduction-to-ggplot2.html#cb297-1" aria-hidden="true" tabindex="-1"></a>plt <span class="ot">&lt;-</span> <span class="fu">ggplot</span>()</span></code></pre></div>
<p>This constructs the skeleton object and assigns it a name, <code>plt</code>. We can use the <code>summary</code> function to inspect this:</p>
<div class="sourceCode" id="cb298"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb298-1"><a href="introduction-to-ggplot2.html#cb298-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(plt)</span></code></pre></div>
<pre><code>## data: [x]
## faceting: &lt;ggproto object: Class FacetNull, Facet, gg&gt;
##     compute_layout: function
##     draw_back: function
##     draw_front: function
##     draw_labels: function
##     draw_panels: function
##     finish_data: function
##     init_scales: function
##     map_data: function
##     params: list
##     setup_data: function
##     setup_params: function
##     shrink: TRUE
##     train_scales: function
##     vars: function
##     super:  &lt;ggproto object: Class FacetNull, Facet, gg&gt;</code></pre>
<p>The output of <code>summary</code> is quite verbose, but the important parts are near the top, just before the <code>faceting:</code> part. In this case, the ‘important part’ is basically empty. This tells us that there are no data, aesthetic mapping, layers, etc associated with <code>plt</code>. All we did was set up an empty graphical object.</p>
<p>By the way… it is not necessary to inspect every <strong>ggplot2</strong> object with <code>summary</code>. However, it can be instructive to do this when first learning about the package.</p>
<div id="ggplot2-vs.-ggplot" class="section level4 unnumbered infobox information">
<h4><strong>ggplot2</strong> vs. <code>ggplot</code></h4>
<p>Notice that the package is called <strong>ggplot2</strong>, but the actual function that does the work of setting up the graphical object is called <code>ggplot</code>. Try not to mix the names up—this is a common source of errors.</p>
</div>
<p>How can we improve on this? We could add a default data set, which we do by passing the name of a data frame or <strong>dplyr</strong> tibble to <code>ggplot</code>. Let’s try this with <code>penguins</code>:</p>
<div class="sourceCode" id="cb300"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb300-1"><a href="introduction-to-ggplot2.html#cb300-1" aria-hidden="true" tabindex="-1"></a>plt <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(penguins)</span>
<span id="cb300-2"><a href="introduction-to-ggplot2.html#cb300-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(plt)</span></code></pre></div>
<pre><code>## data: species, island, bill_length_mm, bill_depth_mm,
##   flipper_length_mm, body_mass_g, sex, year [344x8]
## faceting: &lt;ggproto object: Class FacetNull, Facet, gg&gt;
##     compute_layout: function
##     draw_back: function
##     draw_front: function
##     draw_labels: function
##     draw_panels: function
##     finish_data: function
##     init_scales: function
##     map_data: function
##     params: list
##     setup_data: function
##     setup_params: function
##     shrink: TRUE
##     train_scales: function
##     vars: function
##     super:  &lt;ggproto object: Class FacetNull, Facet, gg&gt;</code></pre>
<p>Notice that when we summarise the resulting object this time, we see that the variables inside <code>penguins</code> (<code>species</code>, <code>island</code>, <code>bill_length_mm</code>, …) now comprise the data associated with the <code>plt</code> object.</p>
<p>The next step is to add a default aesthetic mapping to the graphical object. Remember, this describe how variables in the data are mapped to the aesthetic properties of the layer(s).</p>
<p>One way to think about aesthetic mappings is that they define what kind of relationships the plot will describe. Since we’re making a scatter plot, we need to define mappings for positions on the ‘x’ and ‘y’ axes. We want to investigate how bill depth depends on bill length, so we need to associate<code>bill_length_mm</code> with the x position and <code>bill_depth_mm</code> with the y position.</p>
<p>We define an aesthetic mapping with the <code>aes</code> function. One way to use <code>aes</code> is like this:</p>
<div class="sourceCode" id="cb302"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb302-1"><a href="introduction-to-ggplot2.html#cb302-1" aria-hidden="true" tabindex="-1"></a>plt <span class="ot">&lt;-</span> plt <span class="sc">+</span> <span class="fu">aes</span>(<span class="at">x =</span> bill_length_mm, <span class="at">y =</span> bill_depth_mm)</span></code></pre></div>
<p>This little snippet of R code looks odd at first glance. There are a couple of things to take away from this:</p>
<ol style="list-style-type: decimal">
<li>We can ‘add’ the aesthetic mapping to the <code>plt</code> object using the <code>+</code> operator. This has nothing to do with arithmetic. The <strong>ggplot2</strong> package uses some clever programming tricks to redefine the way <code>+</code> works so that it can be used to combine graphical objects. It takes a bit of getting used to but this is useful because it makes building a plot from the components of the grammar very natural.</li>
<li>The second thing to notice is that an aesthetic mapping is defined by one or more name-value pairs, specified as arguments of <code>aes</code>. The names on the left-hand side of each <code>=</code> refer to the properties of our graphical object (e.g. the ‘x’ and ‘y’ positions). The values on right-hand side refer to variable names in the data we want to associate with these properties.</li>
</ol>
<p>Notice that we overwrote the original <code>plt</code> object with the updated version using the assignment operator. We could have created a distinct object, but there’s usually no need to do this.</p>
<p>Once again, we can inspect the result using <code>summary</code>:</p>
<div class="sourceCode" id="cb303"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb303-1"><a href="introduction-to-ggplot2.html#cb303-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(plt)</span></code></pre></div>
<pre><code>## data: species, island, bill_length_mm, bill_depth_mm,
##   flipper_length_mm, body_mass_g, sex, year [344x8]
## mapping:  x = ~bill_length_mm, y = ~bill_depth_mm
## faceting: &lt;ggproto object: Class FacetNull, Facet, gg&gt;
##     compute_layout: function
##     draw_back: function
##     draw_front: function
##     draw_labels: function
##     draw_panels: function
##     finish_data: function
##     init_scales: function
##     map_data: function
##     params: list
##     setup_data: function
##     setup_params: function
##     shrink: TRUE
##     train_scales: function
##     vars: function
##     super:  &lt;ggproto object: Class FacetNull, Facet, gg&gt;</code></pre>
<p>The data (<code>data:</code>) from the original <code>plt</code> are still there, but now we can also see that two default mappings (<code>mapping:</code>) have been defined for the x and y axis positions. We have successfully used the <code>ggplot</code> and <code>aes</code> functions to set up a graphical object with both default data and aesthetic mappings. Any layers that we now add will use these unless we choose to override them by specifying different options.</p>
<p>We now need to specify a layer that will tell <strong>ggplot2</strong> how to visualise the data. Remember, each layer has five different components: data, aesthetic mappings, a geom, a stat and a position adjustment. Since we have already set up the default data and aesthetic mappings, there’s no need to define these again—<strong>ggplot2</strong> will use the defaults if we leave them out of the layer definition. This leaves the geom, stat and position adjustment.</p>
<p>What kind of geom do we need? A scatter plot allows us to explore a relationship as a series of points. That means we need to add a layer that uses the ‘point’ geom. Simple.</p>
<p>What about the stat and position? Not so simple. These are difficult to explain without drilling down into the details of how <strong>ggplot2</strong> works. The important insight is that both the stat and the position adjustment change the data in some way before plotting it. If we want to avoid having <strong>ggplot2</strong> do anything to other data, the keyword is ‘identity.’ We use this value whenever we want <strong>ggplot2</strong> to plot our data without modification.</p>
<p>We will examine the easy way to add a layer in a moment. However, we’ll use the long-winded approach first because this reveals what happens whenever we build a <strong>ggplot2</strong> object. The general function for adding a layer is simply called <code>layer</code>. Here’s how it works in its most basic usage:</p>
<div class="sourceCode" id="cb305"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb305-1"><a href="introduction-to-ggplot2.html#cb305-1" aria-hidden="true" tabindex="-1"></a>plt <span class="ot">&lt;-</span> plt <span class="sc">+</span> <span class="fu">layer</span>(<span class="at">geom =</span> <span class="st">&quot;point&quot;</span>, <span class="at">stat =</span> <span class="st">&quot;identity&quot;</span>, <span class="at">position =</span> <span class="st">&quot;identity&quot;</span>)</span></code></pre></div>
<p>This adds a layer to the existing <code>plt</code> object with the <code>layer</code> function and overwrites the old version. Again, we add the new component using the <code>+</code> symbol. We set three arguments of the <code>layer</code> function:</p>
<ol style="list-style-type: decimal">
<li>define the <strong>geom</strong>: the name of this argument was <code>geom</code> and the value assigned to it was <code>"point"</code>.</li>
<li>define the <strong>stat</strong>: the name of this argument was <code>stat</code> and the value assigned to it was <code>"identity"</code>.</li>
<li>define the <strong>position adjustment</strong> : the name of this argument was <code>position</code> and the value assigned to it was <code>"identity"</code>.</li>
</ol>
<p>Let’s review the structure of the resulting graphical object one last time to see what we’ve achieved:</p>
<div class="sourceCode" id="cb306"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb306-1"><a href="introduction-to-ggplot2.html#cb306-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(plt)</span></code></pre></div>
<pre><code>## data: species, island, bill_length_mm, bill_depth_mm,
##   flipper_length_mm, body_mass_g, sex, year [344x8]
## mapping:  x = ~bill_length_mm, y = ~bill_depth_mm
## faceting: &lt;ggproto object: Class FacetNull, Facet, gg&gt;
##     compute_layout: function
##     draw_back: function
##     draw_front: function
##     draw_labels: function
##     draw_panels: function
##     finish_data: function
##     init_scales: function
##     map_data: function
##     params: list
##     setup_data: function
##     setup_params: function
##     shrink: TRUE
##     train_scales: function
##     vars: function
##     super:  &lt;ggproto object: Class FacetNull, Facet, gg&gt;
## -----------------------------------
## geom_point: na.rm = FALSE
## stat_identity: na.rm = FALSE
## position_identity</code></pre>
<p>The text above the <code>-----</code> line is the same as before. It summarises the default data and the aesthetic mapping. The text below it summarises the layer we just added. It tells us that this layer will use the points geom (<code>geom_point</code>), the identity stat (<code>stat_identity</code>), and the identity position adjustment (<code>position_identity</code>).</p>
<p>Now <code>plt</code> has everything it needs to render a figure. How do we do this? Simply ‘print’ the object:</p>
<div class="sourceCode" id="cb308"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb308-1"><a href="introduction-to-ggplot2.html#cb308-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(plt)</span></code></pre></div>
<pre><code>## Warning: Removed 2 rows containing missing values (geom_point).</code></pre>
<p><img src="intro-bio-data-book_files/figure-html/unnamed-chunk-172-1.png" width="336" style="display: block; margin: auto;" /></p>
<p>That’s it! We have produced a scatter plot showing how bill depth depends on bill length. Here’s a quick summary of what we did, all in one place with comments:</p>
<div class="sourceCode" id="cb310"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb310-1"><a href="introduction-to-ggplot2.html#cb310-1" aria-hidden="true" tabindex="-1"></a><span class="co"># step 1. set up the skeleton object with a default data set</span></span>
<span id="cb310-2"><a href="introduction-to-ggplot2.html#cb310-2" aria-hidden="true" tabindex="-1"></a>plt <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(penguins)</span>
<span id="cb310-3"><a href="introduction-to-ggplot2.html#cb310-3" aria-hidden="true" tabindex="-1"></a><span class="co"># step 2. add the default aesthetic mappings</span></span>
<span id="cb310-4"><a href="introduction-to-ggplot2.html#cb310-4" aria-hidden="true" tabindex="-1"></a>plt <span class="ot">&lt;-</span> plt <span class="sc">+</span> <span class="fu">aes</span>(<span class="at">x =</span> bill_length_mm, <span class="at">y =</span> bill_depth_mm)</span>
<span id="cb310-5"><a href="introduction-to-ggplot2.html#cb310-5" aria-hidden="true" tabindex="-1"></a><span class="co"># step 3. specify the layer we want to use</span></span>
<span id="cb310-6"><a href="introduction-to-ggplot2.html#cb310-6" aria-hidden="true" tabindex="-1"></a>plt <span class="ot">&lt;-</span> plt <span class="sc">+</span> <span class="fu">layer</span>(<span class="at">geom =</span> <span class="st">&quot;point&quot;</span>, <span class="at">stat =</span> <span class="st">&quot;identity&quot;</span>, <span class="at">position =</span> <span class="st">&quot;identity&quot;</span>)</span>
<span id="cb310-7"><a href="introduction-to-ggplot2.html#cb310-7" aria-hidden="true" tabindex="-1"></a><span class="co"># step 4. render the plot</span></span>
<span id="cb310-8"><a href="introduction-to-ggplot2.html#cb310-8" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(plt)</span></code></pre></div>
<div id="dont-use-this-workflow" class="section level4 unnumbered infobox warning">
<h4>Don’t use this workflow!</h4>
<p>It’s possible to construct any <strong>ggplot2</strong> visualisation using the workflow outlined in this subsection, but <strong>this is not the recommended approach</strong>. The workflow we adopted here was used to reveal how the grammar works, rather than for its efficiency. A more concise, standard approach to using <strong>ggplot2</strong> is outlined next. Use that for real-world analysis.</p>
</div>
</div>
<div id="a-standard-way-of-using-ggplot2" class="section level3" number="13.2.2">
<h3><span class="header-section-number">13.2.2</span> A standard way of using <strong>ggplot2</strong></h3>
<p>The <strong>ggplot2</strong> package is quite flexible, which means we can specify a visualisation in more than one way. To keep life simple, we’re going to adopt a consistent workflow from now on. This won’t reveal the full array of <strong>ggplot2</strong> tricks, but it is sufficient to construct a wide range of standard visualisations. To see it in action, we’ll make the same bill depth vs. bill length scatter plot again.</p>
<p>We began building our <strong>ggplot2</strong> object by setting up a skeleton object with a default data set and then added the default aesthetic mappings. There is a more concise way to achieve the same result:</p>
<div class="sourceCode" id="cb311"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb311-1"><a href="introduction-to-ggplot2.html#cb311-1" aria-hidden="true" tabindex="-1"></a>plt <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(penguins, <span class="fu">aes</span>(<span class="at">x =</span> bill_length_mm, <span class="at">y =</span> bill_depth_mm))</span>
<span id="cb311-2"><a href="introduction-to-ggplot2.html#cb311-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(plt)</span></code></pre></div>
<pre><code>## data: species, island, bill_length_mm, bill_depth_mm,
##   flipper_length_mm, body_mass_g, sex, year [344x8]
## mapping:  x = ~bill_length_mm, y = ~bill_depth_mm
## faceting: &lt;ggproto object: Class FacetNull, Facet, gg&gt;
##     compute_layout: function
##     draw_back: function
##     draw_front: function
##     draw_labels: function
##     draw_panels: function
##     finish_data: function
##     init_scales: function
##     map_data: function
##     params: list
##     setup_data: function
##     setup_params: function
##     shrink: TRUE
##     train_scales: function
##     vars: function
##     super:  &lt;ggproto object: Class FacetNull, Facet, gg&gt;</code></pre>
<p>In this form, the <code>aes</code> function appears inside <code>ggplot</code> as a second argument. This sets up a graphical object with default data and aesthetic mappings in a single step. We will always use this approach from now on.</p>
<p>The next step adds a layer. We saw that the <code>layer</code> function can be used to construct one from its component parts. However, <strong>ggplot2</strong> provides many convenience functions that construct layers according to the type of geom they need.</p>
<p>They all look like this: <code>geom_TYPE</code>, where <code>TYPE</code> stands for the name of the geom we want to use. For example, a point geom is specified using <code>geom_point</code>. Using this function, an alternative to the last line of the example is therefore:</p>
<div class="sourceCode" id="cb313"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb313-1"><a href="introduction-to-ggplot2.html#cb313-1" aria-hidden="true" tabindex="-1"></a>plt <span class="ot">&lt;-</span> plt <span class="sc">+</span> <span class="fu">geom_point</span>()</span></code></pre></div>
<p>We didn’t have to specify the stat or the position adjustment components of the layer because the <code>geom_TYPE</code> functions all use reasonable defaults. These can be overridden if needed, but most of the time, there’s no need to do this. This way of defining a layer is much simpler and less error-prone than the manual <code>layer</code> method. We will always use the <code>geom_TYPE</code> method from now on.</p>
<p>There’s one last trick we need to learn to use <strong>ggplot2</strong> efficiently. We’ve been building a plot object in several steps, giving the intermediates the name <code>plt</code>, and then manually printing the object to display it when it’s ready. This is useful if we want to make different versions of the same plot. However, we very often just want to build the plot and display it in one go. This is done by combining everything with <code>+</code> and printing the resulting object directly:</p>
<div class="sourceCode" id="cb314"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb314-1"><a href="introduction-to-ggplot2.html#cb314-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(penguins, <span class="fu">aes</span>(<span class="at">x =</span> bill_length_mm, <span class="at">y =</span> bill_depth_mm)) <span class="sc">+</span> <span class="fu">geom_point</span>()</span></code></pre></div>
<pre><code>## Warning: Removed 2 rows containing missing values (geom_point).</code></pre>
<p><img src="intro-bio-data-book_files/figure-html/unnamed-chunk-176-1.png" width="336" style="display: block; margin: auto;" /></p>
<p>That code builds the <strong>ggplot2</strong> graphical object and renders it in one go. Notice that we didn’t even have to use <code>print</code> to generate the output. We have seen a lot is going on underneath this, but this small snippet of R code contains everything <strong>ggplot2</strong> needs to construct and display a simple scatter plot.</p>
<p>One last thing… The code for <strong>ggplot2</strong> can get quite complicated, and as always, it’s a good idea to use newlines and white space to improve readability. The usual convention is to put each new function after a <code>+</code> on a new line, like this:</p>
<div class="sourceCode" id="cb316"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb316-1"><a href="introduction-to-ggplot2.html#cb316-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(penguins, <span class="fu">aes</span>(<span class="at">x =</span> bill_length_mm, <span class="at">y =</span> bill_depth_mm)) <span class="sc">+</span> </span>
<span id="cb316-2"><a href="introduction-to-ggplot2.html#cb316-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span></code></pre></div>
<p>Just remember that all the ggplot code joined by <code>+</code> symbols has to be run as one—it all belongs together even if we decide to place the component parts on different lines.</p>
<p>What does this scatter plot actually tell us about penguin bill morphology? It seems to suggest there isn’t much of a relationship between bill depth and bill length. Does that seem sensible? Maybe we need a more informative plot…</p>
</div>
</div>
<div id="increasing-the-information-density" class="section level2" number="13.3">
<h2><span class="header-section-number">13.3</span> Increasing the information density</h2>
<p>We introduced the example by saying that we were interested in the relationship between bill depth and bill length, and how this might vary among species and islands. So far, we’ve only examined the bill depth-length part. We’ll finish this chapter by investigating how this relationship depends on the remaining two variables (<code>species</code> and <code>island</code>). In doing so, we’ll highlight approaches for increasing the amount of information in a visualisation—that’s the real goal of this section.</p>
<div id="using-additional-aesthetics" class="section level3" number="13.3.1">
<h3><span class="header-section-number">13.3.1</span> Using additional aesthetics</h3>
<p>How might we learn whether the bill depth-length relationship varies by penguin species? We need to include information in the <code>species</code> variable in our scatter plot somehow. There are different ways to do this, but the basic trick is to <strong>map the</strong> <code>species</code> <strong>variable to a new aesthetic</strong>.</p>
<p>One option is to map the <code>species</code> to colour so that the colour of the points correspond to different species. We achive this by changing the <code>aes</code> part:</p>
<div class="sourceCode" id="cb317"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb317-1"><a href="introduction-to-ggplot2.html#cb317-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(penguins, </span>
<span id="cb317-2"><a href="introduction-to-ggplot2.html#cb317-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> bill_length_mm, <span class="at">y =</span> bill_depth_mm, <span class="at">colour =</span> species)) <span class="sc">+</span> </span>
<span id="cb317-3"><a href="introduction-to-ggplot2.html#cb317-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span></code></pre></div>
<pre><code>## Warning: Removed 2 rows containing missing values (geom_point).</code></pre>
<p><img src="intro-bio-data-book_files/figure-html/unnamed-chunk-178-1.png" width="432" style="display: block; margin: auto;" /></p>
<p>Individual points are now coloured according to species identity. <strong>ggplot2</strong> also adds a legend to the figure—a colour scale is not much use without a legend. We can see that bill morphology is reasonably species-specific. Separating things by species suggests a (mild) positive association between bill length and bill depth <em>within species</em>. We couldn’t see this before because it was hidden by the <em>among species</em> pattern.</p>
<p>Notice that we put the <code>aes</code> argument on a new line. We did this because that first line was getting a bit long. This is just a readability thing—the <code>aes</code> part still belongs to <code>ggplot</code>.</p>
<p>We could certainly improve this visualisation. Nonetheless, it illustrates an important concept: we can easily add more information to a plot by mapping additional variables to new aesthetics. There is nothing to stop us using different aesthetics if we wanted to squeeze even more information into this plot. For example, we could map the sex variable (<code>sex</code>) to the point shape using <code>shape = sex</code> inside <code>aes</code>. That would allow us to see if the relationship differs by sex within and among species.</p>
</div>
<div id="using-facets" class="section level3" number="13.3.2">
<h3><span class="header-section-number">13.3.2</span> Using facets</h3>
<p>What if we want to see how the bill morphology varies across islands? One way to do this is to make a separate scatter plot for each island. The good news is we don’t have to do this manually. We can use the <strong>faceting</strong> facility of <strong>ggplot2</strong> instead. Faceting allows us to define subsets of data according to the values of one or more variables and produce a separate plot for each subset, all without having to write much R code.</p>
<p>Faceting operates on the whole figure, which means we can’t apply it by changing the properties of a layer. Instead, we have to use a new function to add the faceting information. There are two different ways to facet in <strong>ggplot2</strong>:</p>
<ul>
<li><code>facet_wrap</code> forms a matrix of panels by wrapping the 1d sequence of panels into a 2d matrix with rows and columns. It is typically used with a single categorical faceting variable (though it works with two or more faceting variables).</li>
<li><code>facet_grid</code> forms a 2d matrix of panels defined by row and column variables. It is typically used when we have two or more categorical variables, and all combinations of the variables exist in the data.</li>
</ul>
<p>This is best understood by example. Here’s how we split things up by <code>island</code> using the <code>facet_wrap</code> function:</p>
<div class="sourceCode" id="cb319"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb319-1"><a href="introduction-to-ggplot2.html#cb319-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(penguins, </span>
<span id="cb319-2"><a href="introduction-to-ggplot2.html#cb319-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> bill_length_mm, <span class="at">y =</span> bill_depth_mm, <span class="at">colour =</span> species)) <span class="sc">+</span> </span>
<span id="cb319-3"><a href="introduction-to-ggplot2.html#cb319-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb319-4"><a href="introduction-to-ggplot2.html#cb319-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="fu">vars</span>(island))</span></code></pre></div>
<pre><code>## Warning: Removed 2 rows containing missing values (geom_point).</code></pre>
<p><img src="intro-bio-data-book_files/figure-html/unnamed-chunk-179-1.png" width="643.2" style="display: block; margin: auto;" /></p>
<p>The first argument of <code>facet_wrap</code> (<code>~ island</code>) says to split up the data set according to the values of island. Notice that the panels share the same scales for the ‘x’ and ‘y’ axes. This makes it easy to compare information.</p>
<p>The plot indicates that bill morphology is roughly invariant across the three islands. It also inadvertently reveals something else about these penguins—the Gentoo and Chinstrap species are only found on a single island, which is different for each one, whereas Adelie penguins are found on all three islands. That’s one reason exploratory analysis is so important—it throws up unexpected findings.</p>
<div id="dont-forget-the-vars-part" class="section level4 unnumbered infobox warning">
<h4>Don’t forget the <code>vars</code> part</h4>
<p>We have to wrap the name of the faceting variable with the <code>vars</code> function in the <code>facet_wrap</code> specification. Trust us, <code>facet_wrap</code> won’t work without it.</p>
</div>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="exploratory-data-analysis.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="customising-plots.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["intro-bio-data-book.pdf", "intro-bio-data-book.epub"],
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
